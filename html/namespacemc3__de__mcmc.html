<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>DislocCode: mc3_de_mcmc Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">DislocCode
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">mc3_de_mcmc Namespace Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Script to run Differential Evolution Markov Chain Monte Carlo (DE-MC).  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a864f85bd9175f281dde1d54106019151" id="r_a864f85bd9175f281dde1d54106019151"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a864f85bd9175f281dde1d54106019151">ODE_solution</a> (t)</td></tr>
<tr class="separator:a864f85bd9175f281dde1d54106019151"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5619c74ce95a8ede9f11ebff7d728dcf" id="r_a5619c74ce95a8ede9f11ebff7d728dcf"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5619c74ce95a8ede9f11ebff7d728dcf">x_derivatives</a> (x, t, c0, c1)</td></tr>
<tr class="separator:a5619c74ce95a8ede9f11ebff7d728dcf"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Script to run Differential Evolution Markov Chain Monte Carlo (DE-MC). </p>
<p>This script sets the settings need to run the \(\text{MC}^3\) code to fit the parameters of the non-dimensional equation of motion \(x&#39;&#39; + c_{0}x&#39; = c_{1}\) using the DE-MC algorithm (Braak and Vrugt, <a href="https://doi.org/10.1007/s11222-008-9104-9">https://doi.org/10.1007/s11222-008-9104-9</a>). The full \(\text{MC}^3\) code documentation including a detailed description of the settings used below can be found at <a href="https://mc3.readthedocs.io/en/latest/mcmc_tutorial.html">https://mc3.readthedocs.io/en/latest/mcmc_tutorial.html</a>.</p>
<p>The script reads in the dislocation position vs. time data obtained by post-processing LAMMPS MD trajectories and uses DE-MC to fit the parameters of the above equation of motion. A directory should be set by setting the out_dir variable, where the DE-MC output can be stored. The scripts, <a class="el" href="de__mc__analysis_8py.html">de_mc_analysis.py</a> and mBF_new.py, can be used to analyze the results of the fitting procedure, which give the parameter marginal and joint posterior distributions. In addition to parameter distributions, other outputs of the analysis scripts include trace plots and parameter mean and standard deviation convergence with DE-MC generation (iteration), which can be used for further optimisation of the DE-MC settings provided here.</p>
<p>The script mBF_new.py provides plotting tools, which can ve used to produce additional plots other than those generated by the \(\text{MC}^3\) code (these can be found in the output directory set at the beginning of this script). The de_mcmc.npz file contains the DE_MC accepted samples and is used for further analysis, while the de_mcmc.log and de_mcmc_statistics.txt files contain a summary of the DE-MC fitting procedure output. These files can also be found in the user-set directory defined in this script.</p>
<dl class="section see"><dt>See also</dt><dd></dd></dl>
<p><a class="el" href="dislocation__script_8py.html">dislocation_script.py</a></p>
<p>mBF_new.py </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a864f85bd9175f281dde1d54106019151" name="a864f85bd9175f281dde1d54106019151"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a864f85bd9175f281dde1d54106019151">&#9670;&#160;</a></span>ODE_solution()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ODE_solution </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>t</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Solves the differential equation x" + c0*x' = c1

Parameters
----------
t : numpy.ndarray
    Vector of fitting parameters
</pre> 
<p class="definition">Definition at line <a class="el" href="mc3__de__mcmc_8py_source.html#l00099">99</a> of file <a class="el" href="mc3__de__mcmc_8py_source.html">mc3_de_mcmc.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   99</span><span class="keyword">def </span>ODE_solution(t):</div>
<div class="line"><span class="lineno">  100</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  101</span><span class="stringliteral">    Solves the differential equation x&quot; + c0*x&#39; = c1</span></div>
<div class="line"><span class="lineno">  102</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  103</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  104</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  105</span><span class="stringliteral">    t : numpy.ndarray</span></div>
<div class="line"><span class="lineno">  106</span><span class="stringliteral">        Vector of fitting parameters</span></div>
<div class="line"><span class="lineno">  107</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  108</span>    c0, c1 = t  <span class="comment"># Unpack parameters</span></div>
<div class="line"><span class="lineno">  109</span>    position, velocity = odeint(x_derivatives, x0, t_data, args=(c0,c1)).T</div>
<div class="line"><span class="lineno">  110</span>    <span class="keywordflow">return</span> position</div>
<div class="line"><span class="lineno">  111</span> </div>
<div class="line"><span class="lineno">  112</span><span class="comment"># MC3 settings</span></div>
<div class="line"><span class="lineno">  113</span> </div>
<div class="line"><span class="lineno">  114</span><span class="comment"># Input data</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5619c74ce95a8ede9f11ebff7d728dcf" name="a5619c74ce95a8ede9f11ebff7d728dcf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5619c74ce95a8ede9f11ebff7d728dcf">&#9670;&#160;</a></span>x_derivatives()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">x_derivatives </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>c0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>c1</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Defines the derivatives needed to solve the non-dimensional equation of motion x" + c0*x' = c1

Parameters
----------
x  : numpy.ndarray 
     LHS row vector (dependent variable)
t  : numpy.ndarray
     Time (the independent variable)
c0 : float
     Non-dimensional parameter - B/m
c1  : float
     Non-dimensional parameter - F/m
Returns
-------
numpy.ndarray
      Derrivates.
</pre> 
<p class="definition">Definition at line <a class="el" href="mc3__de__mcmc_8py_source.html#l00074">74</a> of file <a class="el" href="mc3__de__mcmc_8py_source.html">mc3_de_mcmc.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   74</span><span class="keyword">def </span>x_derivatives(x,t,c0,c1):</div>
<div class="line"><span class="lineno">   75</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   76</span><span class="stringliteral">    Defines the derivatives needed to solve the non-dimensional equation of motion x&quot; + c0*x&#39; = c1</span></div>
<div class="line"><span class="lineno">   77</span><span class="stringliteral">    </span></div>
<div class="line"><span class="lineno">   78</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">   79</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">   80</span><span class="stringliteral">    x  : numpy.ndarray </span></div>
<div class="line"><span class="lineno">   81</span><span class="stringliteral">         LHS row vector (dependent variable)</span></div>
<div class="line"><span class="lineno">   82</span><span class="stringliteral">    t  : numpy.ndarray</span></div>
<div class="line"><span class="lineno">   83</span><span class="stringliteral">         Time (the independent variable)</span></div>
<div class="line"><span class="lineno">   84</span><span class="stringliteral">    c0 : float</span></div>
<div class="line"><span class="lineno">   85</span><span class="stringliteral">         Non-dimensional parameter - B/m</span></div>
<div class="line"><span class="lineno">   86</span><span class="stringliteral">    c1  : float</span></div>
<div class="line"><span class="lineno">   87</span><span class="stringliteral">         Non-dimensional parameter - F/m</span></div>
<div class="line"><span class="lineno">   88</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">   89</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">   90</span><span class="stringliteral">    numpy.ndarray</span></div>
<div class="line"><span class="lineno">   91</span><span class="stringliteral">          Derrivates.</span></div>
<div class="line"><span class="lineno">   92</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   93</span>    dxdt = [x[1], np.exp(c1)- np.exp(c0)*x[1]]</div>
<div class="line"><span class="lineno">   94</span>    <span class="keywordflow">return</span> dxdt</div>
<div class="line"><span class="lineno">   95</span> </div>
<div class="line"><span class="lineno">   96</span><span class="comment"># Set the initial conditions - initial position and velocity</span></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0
</small></address>
</body>
</html>
