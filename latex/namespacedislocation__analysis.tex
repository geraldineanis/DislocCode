\doxysection{dislocation\+\_\+analysis Namespace Reference}
\hypertarget{namespacedislocation__analysis}{}\label{namespacedislocation__analysis}\index{dislocation\_analysis@{dislocation\_analysis}}


Dislocation trajectory analysis module.  


\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{namespacedislocation__analysis_a3b980b79feacf39c4e65476bda9c0e42}{get\+\_\+avg\+\_\+pos}} (dislocation)
\item 
\mbox{\hyperlink{namespacedislocation__analysis_a8d90bf172b2934bc622a56e03cc49dcc}{get\+\_\+cell\+\_\+lims}} (dump\+\_\+file)
\item 
\mbox{\hyperlink{namespacedislocation__analysis_a6db068cc761ab189dbbe6a55f4c8b982}{get\+\_\+disloc\+\_\+coords}} (dislocation)
\item 
\mbox{\hyperlink{namespacedislocation__analysis_a2def0450b05616480c8446dc78ccb4d0}{get\+\_\+velocity}} (disloc\+\_\+x\+\_\+pos, timestep)
\item 
\mbox{\hyperlink{namespacedislocation__analysis_a509c3eeaed17b3ea4c6402fd6e674c7d}{perfect\+\_\+disloc\+\_\+coords}} (partial\+\_\+1, partial\+\_\+2)
\item 
\mbox{\hyperlink{namespacedislocation__analysis_aae429f90ce8c140b926470b760cbcd01}{read\+\_\+disloc\+\_\+data}} (disloc\+\_\+file)
\item 
\mbox{\hyperlink{namespacedislocation__analysis_a0698b7189d8fc15d0b9c235010feead3}{track\+\_\+disloc}} (avg, x\+\_\+lim)
\item 
\mbox{\hyperlink{namespacedislocation__analysis_a34abca717001b69ffaddd617df73d6e0}{wrap\+\_\+coords}} (dislocation, ax, extent)
\item 
\mbox{\hyperlink{namespacedislocation__analysis_ab7efed17b69b14fe72695ecdd14ca09b}{write\+\_\+prop}} (filename, property, time)
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Dislocation trajectory analysis module. 

This module contains functions that are used in the script \doxylink{dislocation__script_8py}{dislocation\+\_\+script.\+py}.

The functions contained in this module allow the user to analyse Molecular Dynamics (MD) trajectories of straight edge dislocations generated using LAMMPS.

The script \doxylink{ovito__disloc_8py}{ovito\+\_\+disloc.\+py} post-\/processes dislocation trajectories generated as LAMMPS dumps files containing the unwrapped coordinates of atoms. The functions in this script use as input the text files generated by \doxylink{ovito__disloc_8py}{ovito\+\_\+disloc.\+py}, which uses the OVITO Dislocation Analysis (DXA) tool to detect dislocations. The format of the text files generated by \doxylink{ovito__disloc_8py}{ovito\+\_\+disloc.\+py} is described in further detail in its documentation.

The function track\+\_\+disloc included here allows the user to track dislocations across the various frames of a trajectory, since in a simulation containing multiple dislocations, different dislocations are indexed differently by the DXA tool. Accordingly, this function allows the user to "{}track"{} a given dislocation throughout a trajectory for further processing such as studying its dynamics.

The script \doxylink{dislocation__script_8py}{dislocation\+\_\+script.\+py} shows how the other functions in this module can be used to carry out additional processing of dislocation data files that is necessary prior to using track\+\_\+disloc. 

\doxysubsection{Function Documentation}
\Hypertarget{namespacedislocation__analysis_a3b980b79feacf39c4e65476bda9c0e42}\label{namespacedislocation__analysis_a3b980b79feacf39c4e65476bda9c0e42} 
\index{dislocation\_analysis@{dislocation\_analysis}!get\_avg\_pos@{get\_avg\_pos}}
\index{get\_avg\_pos@{get\_avg\_pos}!dislocation\_analysis@{dislocation\_analysis}}
\doxysubsubsection{\texorpdfstring{get\_avg\_pos()}{get\_avg\_pos()}}
{\footnotesize\ttfamily get\+\_\+avg\+\_\+pos (\begin{DoxyParamCaption}\item[{}]{dislocation }\end{DoxyParamCaption})}

\begin{DoxyVerb}Calculate average position of a dislocation line.

Parameters
----------
dislocation : numpy.ndarray
              Dislocation line coordinates.

Returns
-------
numpy.ndarray
              Average dislocation line coordinates in x, y, and z.
\end{DoxyVerb}
 

Definition at line \mbox{\hyperlink{dislocation__analysis_8py_source_l00151}{151}} of file \mbox{\hyperlink{dislocation__analysis_8py_source}{dislocation\+\_\+analysis.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00151\ \textcolor{keyword}{def\ }get\_avg\_pos(dislocation):}
\DoxyCodeLine{00152\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{00153\ \textcolor{stringliteral}{\ \ \ \ Calculate\ average\ position\ of\ a\ dislocation\ line.}}
\DoxyCodeLine{00154\ \textcolor{stringliteral}{\ \ \ \ }}
\DoxyCodeLine{00155\ \textcolor{stringliteral}{\ \ \ \ Parameters}}
\DoxyCodeLine{00156\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00157\ \textcolor{stringliteral}{\ \ \ \ dislocation\ :\ numpy.ndarray}}
\DoxyCodeLine{00158\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Dislocation\ line\ coordinates.}}
\DoxyCodeLine{00159\ \textcolor{stringliteral}{\ \ \ \ }}
\DoxyCodeLine{00160\ \textcolor{stringliteral}{\ \ \ \ Returns}}
\DoxyCodeLine{00161\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00162\ \textcolor{stringliteral}{\ \ \ \ numpy.ndarray}}
\DoxyCodeLine{00163\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Average\ dislocation\ line\ coordinates\ in\ x,\ y,\ and\ z.}}
\DoxyCodeLine{00164\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{00165\ \ \ \ \ x\_coords,\ y\_coords,\ z\_coords\ =\ get\_disloc\_coords(dislocation)}
\DoxyCodeLine{00166\ \ \ \ \ avg\_pos\ =\ [np.average(x\_coords),np.average(y\_coords),np.average(z\_coords)]}
\DoxyCodeLine{00167\ }
\DoxyCodeLine{00168\ \ \ \ \ \textcolor{keywordflow}{return}\ np.array(avg\_pos)}
\DoxyCodeLine{00169\ }

\end{DoxyCode}
\Hypertarget{namespacedislocation__analysis_a8d90bf172b2934bc622a56e03cc49dcc}\label{namespacedislocation__analysis_a8d90bf172b2934bc622a56e03cc49dcc} 
\index{dislocation\_analysis@{dislocation\_analysis}!get\_cell\_lims@{get\_cell\_lims}}
\index{get\_cell\_lims@{get\_cell\_lims}!dislocation\_analysis@{dislocation\_analysis}}
\doxysubsubsection{\texorpdfstring{get\_cell\_lims()}{get\_cell\_lims()}}
{\footnotesize\ttfamily get\+\_\+cell\+\_\+lims (\begin{DoxyParamCaption}\item[{}]{dump\+\_\+file }\end{DoxyParamCaption})}

\begin{DoxyVerb}Extract simulation cell extents from a LAMMPS dump file.

Parameters
----------
dump_file : str
            LAMMPS dump file name.

Returns
-------
float
            Simulation cell length in x (Angstroms).
float
            Simulation cell length in y (Angstroms).
float
            Simulation cell length in z (Angstroms).            
\end{DoxyVerb}
 

Definition at line \mbox{\hyperlink{dislocation__analysis_8py_source_l00067}{67}} of file \mbox{\hyperlink{dislocation__analysis_8py_source}{dislocation\+\_\+analysis.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00067\ \textcolor{keyword}{def\ }get\_cell\_lims(dump\_file):}
\DoxyCodeLine{00068\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{00069\ \textcolor{stringliteral}{\ \ \ \ Extract\ simulation\ cell\ extents\ from\ a\ LAMMPS\ dump\ file.}}
\DoxyCodeLine{00070\ \textcolor{stringliteral}{}}
\DoxyCodeLine{00071\ \textcolor{stringliteral}{\ \ \ \ Parameters}}
\DoxyCodeLine{00072\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00073\ \textcolor{stringliteral}{\ \ \ \ dump\_file\ :\ str}}
\DoxyCodeLine{00074\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ LAMMPS\ dump\ file\ name.}}
\DoxyCodeLine{00075\ \textcolor{stringliteral}{}}
\DoxyCodeLine{00076\ \textcolor{stringliteral}{\ \ \ \ Returns}}
\DoxyCodeLine{00077\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00078\ \textcolor{stringliteral}{\ \ \ \ float}}
\DoxyCodeLine{00079\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Simulation\ cell\ length\ in\ x\ (Angstroms).}}
\DoxyCodeLine{00080\ \textcolor{stringliteral}{\ \ \ \ float}}
\DoxyCodeLine{00081\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Simulation\ cell\ length\ in\ y\ (Angstroms).}}
\DoxyCodeLine{00082\ \textcolor{stringliteral}{\ \ \ \ float}}
\DoxyCodeLine{00083\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Simulation\ cell\ length\ in\ z\ (Angstroms).\ \ \ \ \ \ \ \ \ \ \ \ }}
\DoxyCodeLine{00084\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{00085\ \ \ \ \ dump\ =\ np.loadtxt(f\textcolor{stringliteral}{"{}\{dump\_file\}"{}},\ skiprows=5,\ max\_rows=3)}
\DoxyCodeLine{00086\ \ \ \ \ lims\ =\ []}
\DoxyCodeLine{00087\ \ \ \ \ \textcolor{keywordflow}{for}\ i\ \textcolor{keywordflow}{in}\ range(3):}
\DoxyCodeLine{00088\ \ \ \ \ \ \ \ \ lims.append(dump[i][1]\ -\/\ dump[i][0])}
\DoxyCodeLine{00089\ \ \ \ \ \textcolor{keywordflow}{return}\ lims[0],\ lims[1],\ lims[2]}
\DoxyCodeLine{00090\ }

\end{DoxyCode}
\Hypertarget{namespacedislocation__analysis_a6db068cc761ab189dbbe6a55f4c8b982}\label{namespacedislocation__analysis_a6db068cc761ab189dbbe6a55f4c8b982} 
\index{dislocation\_analysis@{dislocation\_analysis}!get\_disloc\_coords@{get\_disloc\_coords}}
\index{get\_disloc\_coords@{get\_disloc\_coords}!dislocation\_analysis@{dislocation\_analysis}}
\doxysubsubsection{\texorpdfstring{get\_disloc\_coords()}{get\_disloc\_coords()}}
{\footnotesize\ttfamily get\+\_\+disloc\+\_\+coords (\begin{DoxyParamCaption}\item[{}]{dislocation }\end{DoxyParamCaption})}

\begin{DoxyVerb}Extract and split coordinates of a dislocation line.

Parameters
----------
dislocation : numpy.ndarray
              Dislocation line coordinates.

Returns
-------
numpy.ndarray
              Dislocation line x coordinates.
numpy.ndarray
              Dislocation line y coordinates.
numpy.ndarray
              Dislocation line z coordinates.                                    
\end{DoxyVerb}
 

Definition at line \mbox{\hyperlink{dislocation__analysis_8py_source_l00127}{127}} of file \mbox{\hyperlink{dislocation__analysis_8py_source}{dislocation\+\_\+analysis.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00127\ \textcolor{keyword}{def\ }get\_disloc\_coords(dislocation):}
\DoxyCodeLine{00128\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{00129\ \textcolor{stringliteral}{\ \ \ \ Extract\ and\ split\ coordinates\ of\ a\ dislocation\ line.}}
\DoxyCodeLine{00130\ \textcolor{stringliteral}{}}
\DoxyCodeLine{00131\ \textcolor{stringliteral}{\ \ \ \ Parameters}}
\DoxyCodeLine{00132\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00133\ \textcolor{stringliteral}{\ \ \ \ dislocation\ :\ numpy.ndarray}}
\DoxyCodeLine{00134\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Dislocation\ line\ coordinates.}}
\DoxyCodeLine{00135\ \textcolor{stringliteral}{\ \ \ \ }}
\DoxyCodeLine{00136\ \textcolor{stringliteral}{\ \ \ \ Returns}}
\DoxyCodeLine{00137\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00138\ \textcolor{stringliteral}{\ \ \ \ numpy.ndarray}}
\DoxyCodeLine{00139\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Dislocation\ line\ x\ coordinates.}}
\DoxyCodeLine{00140\ \textcolor{stringliteral}{\ \ \ \ numpy.ndarray}}
\DoxyCodeLine{00141\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Dislocation\ line\ y\ coordinates.}}
\DoxyCodeLine{00142\ \textcolor{stringliteral}{\ \ \ \ numpy.ndarray}}
\DoxyCodeLine{00143\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Dislocation\ line\ z\ coordinates.\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }}
\DoxyCodeLine{00144\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{00145\ \ \ \ \ x\_coords\ =\ np.array(dislocation,\ dtype=object)[:,0]}
\DoxyCodeLine{00146\ \ \ \ \ y\_coords\ =\ np.array(dislocation,\ dtype=object)[:,1]}
\DoxyCodeLine{00147\ \ \ \ \ z\_coords\ =\ np.array(dislocation,\ dtype=object)[:,2]}
\DoxyCodeLine{00148\ }
\DoxyCodeLine{00149\ \ \ \ \ \textcolor{keywordflow}{return}\ x\_coords,\ y\_coords,\ z\_coords}
\DoxyCodeLine{00150\ }

\end{DoxyCode}
\Hypertarget{namespacedislocation__analysis_a2def0450b05616480c8446dc78ccb4d0}\label{namespacedislocation__analysis_a2def0450b05616480c8446dc78ccb4d0} 
\index{dislocation\_analysis@{dislocation\_analysis}!get\_velocity@{get\_velocity}}
\index{get\_velocity@{get\_velocity}!dislocation\_analysis@{dislocation\_analysis}}
\doxysubsubsection{\texorpdfstring{get\_velocity()}{get\_velocity()}}
{\footnotesize\ttfamily get\+\_\+velocity (\begin{DoxyParamCaption}\item[{}]{disloc\+\_\+x\+\_\+pos,  }\item[{}]{timestep }\end{DoxyParamCaption})}

\begin{DoxyVerb}Function to calculate a dislocation line's x-component of velocity in Angstroms/ps.

Parameters
----------
disloc_x_pos : list
               Dislocation line x-coordinates timeseries.
timestep     : float
               Simulation timestep in ps.\end{DoxyVerb}
 

Definition at line \mbox{\hyperlink{dislocation__analysis_8py_source_l00190}{190}} of file \mbox{\hyperlink{dislocation__analysis_8py_source}{dislocation\+\_\+analysis.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00190\ \textcolor{keyword}{def\ }get\_velocity(disloc\_x\_pos,\ timestep):}
\DoxyCodeLine{00191\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{00192\ \textcolor{stringliteral}{\ \ \ \ Function\ to\ calculate\ a\ dislocation\ line's\ x-\/component\ of\ velocity\ in\ Angstroms/ps.}}
\DoxyCodeLine{00193\ \textcolor{stringliteral}{}}
\DoxyCodeLine{00194\ \textcolor{stringliteral}{\ \ \ \ Parameters}}
\DoxyCodeLine{00195\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00196\ \textcolor{stringliteral}{\ \ \ \ disloc\_x\_pos\ :\ list}}
\DoxyCodeLine{00197\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Dislocation\ line\ x-\/coordinates\ timeseries.}}
\DoxyCodeLine{00198\ \textcolor{stringliteral}{\ \ \ \ timestep\ \ \ \ \ :\ float}}
\DoxyCodeLine{00199\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Simulation\ timestep\ in\ ps.}}
\DoxyCodeLine{00200\ \textcolor{stringliteral}{}}
\DoxyCodeLine{00201\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{00202\ \ \ \ \ \textcolor{keywordflow}{return}\ np.gradient(disloc\_x\_pos,\ timestep)}
\DoxyCodeLine{00203\ }

\end{DoxyCode}
\Hypertarget{namespacedislocation__analysis_a509c3eeaed17b3ea4c6402fd6e674c7d}\label{namespacedislocation__analysis_a509c3eeaed17b3ea4c6402fd6e674c7d} 
\index{dislocation\_analysis@{dislocation\_analysis}!perfect\_disloc\_coords@{perfect\_disloc\_coords}}
\index{perfect\_disloc\_coords@{perfect\_disloc\_coords}!dislocation\_analysis@{dislocation\_analysis}}
\doxysubsubsection{\texorpdfstring{perfect\_disloc\_coords()}{perfect\_disloc\_coords()}}
{\footnotesize\ttfamily perfect\+\_\+disloc\+\_\+coords (\begin{DoxyParamCaption}\item[{}]{partial\+\_\+1,  }\item[{}]{partial\+\_\+2 }\end{DoxyParamCaption})}

\begin{DoxyVerb}Calculate the x-coordinates of a perfect dislocation 
as the average of the x-coordinates of two partial dislocations
at every simulation timestep.

Parameters
----------
partial_1 : list
            First partial dislocation x-coordinates timeseries.
partial_2 : list
            Second partial dislocation x-coordinates timeseries.                
            
Returns
-------
numpy.ndarray
            Perfect dislocation x-coordinates timeseries.                
\end{DoxyVerb}
 

Definition at line \mbox{\hyperlink{dislocation__analysis_8py_source_l00170}{170}} of file \mbox{\hyperlink{dislocation__analysis_8py_source}{dislocation\+\_\+analysis.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00170\ \textcolor{keyword}{def\ }perfect\_disloc\_coords(partial\_1,\ partial\_2):}
\DoxyCodeLine{00171\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{00172\ \textcolor{stringliteral}{\ \ \ \ Calculate\ the\ x-\/coordinates\ of\ a\ perfect\ dislocation\ }}
\DoxyCodeLine{00173\ \textcolor{stringliteral}{\ \ \ \ as\ the\ average\ of\ the\ x-\/coordinates\ of\ two\ partial\ dislocations}}
\DoxyCodeLine{00174\ \textcolor{stringliteral}{\ \ \ \ at\ every\ simulation\ timestep.}}
\DoxyCodeLine{00175\ \textcolor{stringliteral}{}}
\DoxyCodeLine{00176\ \textcolor{stringliteral}{\ \ \ \ Parameters}}
\DoxyCodeLine{00177\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00178\ \textcolor{stringliteral}{\ \ \ \ partial\_1\ :\ list}}
\DoxyCodeLine{00179\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ First\ partial\ dislocation\ x-\/coordinates\ timeseries.}}
\DoxyCodeLine{00180\ \textcolor{stringliteral}{\ \ \ \ partial\_2\ :\ list}}
\DoxyCodeLine{00181\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Second\ partial\ dislocation\ x-\/coordinates\ timeseries.\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }}
\DoxyCodeLine{00182\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }}
\DoxyCodeLine{00183\ \textcolor{stringliteral}{\ \ \ \ Returns}}
\DoxyCodeLine{00184\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00185\ \textcolor{stringliteral}{\ \ \ \ numpy.ndarray}}
\DoxyCodeLine{00186\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Perfect\ dislocation\ x-\/coordinates\ timeseries.\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }}
\DoxyCodeLine{00187\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{00188\ \ \ \ \ \textcolor{keywordflow}{return}\ np.array([np.average([partial\_1[i],\ partial\_2[i]])\ \textcolor{keywordflow}{for}\ i\ \textcolor{keywordflow}{in}\ range(len(partial\_1))])}
\DoxyCodeLine{00189\ }

\end{DoxyCode}
\Hypertarget{namespacedislocation__analysis_aae429f90ce8c140b926470b760cbcd01}\label{namespacedislocation__analysis_aae429f90ce8c140b926470b760cbcd01} 
\index{dislocation\_analysis@{dislocation\_analysis}!read\_disloc\_data@{read\_disloc\_data}}
\index{read\_disloc\_data@{read\_disloc\_data}!dislocation\_analysis@{dislocation\_analysis}}
\doxysubsubsection{\texorpdfstring{read\_disloc\_data()}{read\_disloc\_data()}}
{\footnotesize\ttfamily read\+\_\+disloc\+\_\+data (\begin{DoxyParamCaption}\item[{}]{disloc\+\_\+file }\end{DoxyParamCaption})}

\begin{DoxyVerb}Read in dislocation position data obtained from 
processing MD trajectory using OVITO sctript provided.

Parameters
----------
disloc_file : str
              Dislocation data file name.

Returns
-------
numpy.ndarray
              Dislocation line x, y, and z coordinates.
\end{DoxyVerb}
 

Definition at line \mbox{\hyperlink{dislocation__analysis_8py_source_l00031}{31}} of file \mbox{\hyperlink{dislocation__analysis_8py_source}{dislocation\+\_\+analysis.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00031\ \textcolor{keyword}{def\ }read\_disloc\_data(disloc\_file):}
\DoxyCodeLine{00032\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{00033\ \textcolor{stringliteral}{\ \ \ \ Read\ in\ dislocation\ position\ data\ obtained\ from\ }}
\DoxyCodeLine{00034\ \textcolor{stringliteral}{\ \ \ \ processing\ MD\ trajectory\ using\ OVITO\ sctript\ provided.}}
\DoxyCodeLine{00035\ \textcolor{stringliteral}{}}
\DoxyCodeLine{00036\ \textcolor{stringliteral}{\ \ \ \ Parameters}}
\DoxyCodeLine{00037\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00038\ \textcolor{stringliteral}{\ \ \ \ disloc\_file\ :\ str}}
\DoxyCodeLine{00039\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Dislocation\ data\ file\ name.}}
\DoxyCodeLine{00040\ \textcolor{stringliteral}{\ \ \ \ }}
\DoxyCodeLine{00041\ \textcolor{stringliteral}{\ \ \ \ Returns}}
\DoxyCodeLine{00042\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00043\ \textcolor{stringliteral}{\ \ \ \ numpy.ndarray}}
\DoxyCodeLine{00044\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Dislocation\ line\ x,\ y,\ and\ z\ coordinates.}}
\DoxyCodeLine{00045\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{00046\ \ \ \ \ \textcolor{keyword}{with}\ open(disloc\_file)\ \textcolor{keyword}{as}\ f:}
\DoxyCodeLine{00047\ \ \ \ \ \ \ \ \ ndisloc\ =\ int(f.readline())\ \ \ \ \ \textcolor{comment}{\#\ number\ of\ dislocations\ \ \ \ }}
\DoxyCodeLine{00048\ \ \ \ \ \ \ \ \ indices\ =\ []\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ indices\ of\ dislocations\ }}
\DoxyCodeLine{00049\ \ \ \ \ \ \ \ \ lens\ =\ []\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ lengths\ of\ dislocations}}
\DoxyCodeLine{00050\ \ \ \ \ \ \ \ \ dislocations\ =\ []\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ coordinates\ of\ dislocations}}
\DoxyCodeLine{00051\ }
\DoxyCodeLine{00052\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Read\ dislocation\ coordinates\ for\ each\ dislocation\ found}}
\DoxyCodeLine{00053\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ i\ \textcolor{keywordflow}{in}\ range(ndisloc):}
\DoxyCodeLine{00054\ \ \ \ \ \ \ \ \ \ \ \ \ disloc\_i\ =\ []}
\DoxyCodeLine{00055\ \ \ \ \ \ \ \ \ \ \ \ \ index\ =\ indices.append(int(f.readline().strip()))}
\DoxyCodeLine{00056\ \ \ \ \ \ \ \ \ \ \ \ \ length\ =\ int(f.readline().strip())}
\DoxyCodeLine{00057\ \ \ \ \ \ \ \ \ \ \ \ \ lens.append(length)}
\DoxyCodeLine{00058\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ i\ \textcolor{keywordflow}{in}\ range(length):}
\DoxyCodeLine{00059\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ coords\ =\ f.readline().strip()}
\DoxyCodeLine{00060\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ coords\ =\ np.array(coords.split())}
\DoxyCodeLine{00061\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ coords\ =\ coords.astype(np.float64)}
\DoxyCodeLine{00062\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ disloc\_i.append(coords)}
\DoxyCodeLine{00063\ \ \ \ \ \ \ \ \ \ \ \ \ dislocations.append(disloc\_i)}
\DoxyCodeLine{00064\ }
\DoxyCodeLine{00065\ \ \ \ \ \textcolor{keywordflow}{return}\ np.array(dislocations,\ dtype=object)}
\DoxyCodeLine{00066\ }

\end{DoxyCode}
\Hypertarget{namespacedislocation__analysis_a0698b7189d8fc15d0b9c235010feead3}\label{namespacedislocation__analysis_a0698b7189d8fc15d0b9c235010feead3} 
\index{dislocation\_analysis@{dislocation\_analysis}!track\_disloc@{track\_disloc}}
\index{track\_disloc@{track\_disloc}!dislocation\_analysis@{dislocation\_analysis}}
\doxysubsubsection{\texorpdfstring{track\_disloc()}{track\_disloc()}}
{\footnotesize\ttfamily track\+\_\+disloc (\begin{DoxyParamCaption}\item[{}]{avg,  }\item[{}]{x\+\_\+lim }\end{DoxyParamCaption})}

\begin{DoxyVerb}Track dislocation lines across multiple frames.
- Dislocations are tracked by checking the minimum distance moved by a dislocation between frames. 

- Adapted from the approach in:
https://pysource.com/2021/10/05/object-tracking-from-scratch-opencv-and-python/

- Assumptions:
1. The dislocation only moves in the x direction
2. The number of dislocations is constant across all frames 
i.e. no dislocations are generated nor lost throughout the analysed trajectory.

Parameters
----------
avg      : numpy.ndarray
           Average x, y, and z coordinates of dislocation lines in the analysed trajectory.
x_lim    : float
           Simulation cell length in x (Angstroms).
n_frames : int
           Number of frames in trajectory.

Returns
-------
list
           Sorted dislocation x-coordinates across trajectory frames.
list
           Sorted coordinates of dislocation line vertices across frames.
list
           Timesteps.\end{DoxyVerb}
 

Definition at line \mbox{\hyperlink{dislocation__analysis_8py_source_l00223}{223}} of file \mbox{\hyperlink{dislocation__analysis_8py_source}{dislocation\+\_\+analysis.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00223\ \textcolor{keyword}{def\ }track\_disloc(avg,\ x\_lim):}
\DoxyCodeLine{00224\ }
\DoxyCodeLine{00225\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{00226\ \textcolor{stringliteral}{\ \ \ \ Track\ dislocation\ lines\ across\ multiple\ frames.}}
\DoxyCodeLine{00227\ \textcolor{stringliteral}{\ \ \ \ -\/\ Dislocations\ are\ tracked\ by\ checking\ the\ minimum\ distance\ moved\ by\ a\ dislocation\ between\ frames.\ }}
\DoxyCodeLine{00228\ \textcolor{stringliteral}{\ \ \ \ }}
\DoxyCodeLine{00229\ \textcolor{stringliteral}{\ \ \ \ -\/\ Adapted\ from\ the\ approach\ in:}}
\DoxyCodeLine{00230\ \textcolor{stringliteral}{\ \ \ \ https://pysource.com/2021/10/05/object-\/tracking-\/from-\/scratch-\/opencv-\/and-\/python/}}
\DoxyCodeLine{00231\ \textcolor{stringliteral}{\ \ \ \ }}
\DoxyCodeLine{00232\ \textcolor{stringliteral}{\ \ \ \ -\/\ Assumptions:}}
\DoxyCodeLine{00233\ \textcolor{stringliteral}{\ \ \ \ 1.\ The\ dislocation\ only\ moves\ in\ the\ x\ direction}}
\DoxyCodeLine{00234\ \textcolor{stringliteral}{\ \ \ \ 2.\ The\ number\ of\ dislocations\ is\ constant\ across\ all\ frames\ }}
\DoxyCodeLine{00235\ \textcolor{stringliteral}{\ \ \ \ i.e.\ no\ dislocations\ are\ generated\ nor\ lost\ throughout\ the\ analysed\ trajectory.}}
\DoxyCodeLine{00236\ \textcolor{stringliteral}{\ \ \ \ }}
\DoxyCodeLine{00237\ \textcolor{stringliteral}{\ \ \ \ Parameters}}
\DoxyCodeLine{00238\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00239\ \textcolor{stringliteral}{\ \ \ \ avg\ \ \ \ \ \ :\ numpy.ndarray}}
\DoxyCodeLine{00240\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Average\ x,\ y,\ and\ z\ coordinates\ of\ dislocation\ lines\ in\ the\ analysed\ trajectory.}}
\DoxyCodeLine{00241\ \textcolor{stringliteral}{\ \ \ \ x\_lim\ \ \ \ :\ float}}
\DoxyCodeLine{00242\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Simulation\ cell\ length\ in\ x\ (Angstroms).}}
\DoxyCodeLine{00243\ \textcolor{stringliteral}{\ \ \ \ n\_frames\ :\ int}}
\DoxyCodeLine{00244\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Number\ of\ frames\ in\ trajectory.}}
\DoxyCodeLine{00245\ \textcolor{stringliteral}{\ \ \ \ }}
\DoxyCodeLine{00246\ \textcolor{stringliteral}{\ \ \ \ Returns}}
\DoxyCodeLine{00247\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00248\ \textcolor{stringliteral}{\ \ \ \ list}}
\DoxyCodeLine{00249\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Sorted\ dislocation\ x-\/coordinates\ across\ trajectory\ frames.}}
\DoxyCodeLine{00250\ \textcolor{stringliteral}{\ \ \ \ list}}
\DoxyCodeLine{00251\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Sorted\ coordinates\ of\ dislocation\ line\ vertices\ across\ frames.}}
\DoxyCodeLine{00252\ \textcolor{stringliteral}{\ \ \ \ list}}
\DoxyCodeLine{00253\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Timesteps.}}
\DoxyCodeLine{00254\ \textcolor{stringliteral}{\ \ \ \ }}
\DoxyCodeLine{00255\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{00256\ \ \ \ \ \textcolor{comment}{\#\ Tracking\ ID}}
\DoxyCodeLine{00257\ \ \ \ \ track\_ID\ =\ 0}
\DoxyCodeLine{00258\ }
\DoxyCodeLine{00259\ \ \ \ \ \textcolor{comment}{\#\ Dictionary\ to\ store\ dislocations}}
\DoxyCodeLine{00260\ \ \ \ \ tracking\_objects\ =\ defaultdict(list)}
\DoxyCodeLine{00261\ }
\DoxyCodeLine{00262\ \ \ \ \ \textcolor{comment}{\#\ Compare\ x\ coordinate\ of\ average\ position}}
\DoxyCodeLine{00263\ \ \ \ \ \textcolor{comment}{\#\ first\ we\ only\ compare\ the\ first\ and\ second\ frames}}
\DoxyCodeLine{00264\ \ \ \ \ \textcolor{comment}{\#\ to\ determine\ object\ id\ at\ beginning}}
\DoxyCodeLine{00265\ \ \ \ \ \textcolor{comment}{\#\ This\ sorts\ the\ first\ two\ points\ well}}
\DoxyCodeLine{00266\ }
\DoxyCodeLine{00267\ \ \ \ \ \textcolor{comment}{\#\ Cutoff\ distance}}
\DoxyCodeLine{00268\ \ \ \ \ d\_cutoff\ =\ 5.0\ \textcolor{comment}{\#\ Angstroms}}
\DoxyCodeLine{00269\ }
\DoxyCodeLine{00270\ \ \ \ \ \textcolor{keywordflow}{for}\ i\ \textcolor{keywordflow}{in}\ range(1,2):}
\DoxyCodeLine{00271\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ j\ \textcolor{keywordflow}{in}\ range(len(avg[i])):}
\DoxyCodeLine{00272\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ k\ \textcolor{keywordflow}{in}\ range(len(avg[i])):}
\DoxyCodeLine{00273\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ displacement\ =\ avg[i][j][0][0]\ -\/\ avg[i-\/1][k][0][0]}
\DoxyCodeLine{00274\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ abs(displacement)\ <\ d\_cutoff:}
\DoxyCodeLine{00275\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pbc\ =\ \textcolor{keyword}{False}}
\DoxyCodeLine{00276\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tracking\_objects[track\_ID].append([i-\/1,np.array([avg[i-\/1][k][0][0],\ avg[i-\/1][k][0][1],\ avg[i-\/1][k][0][2]]),int(pbc),avg[i-\/1][k][1]])\ \textcolor{comment}{\#\ first\ frame\ coordinates}}
\DoxyCodeLine{00277\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tracking\_objects[track\_ID].append([i,np.array([avg[i][j][0][0],\ avg[i][j][0][1],\ avg[i][j][0][2]]),int(pbc),avg[i][j][1]])\ \ \ \textcolor{comment}{\#\ second\ frame\ coordinates}}
\DoxyCodeLine{00278\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ track\_ID\ +=\ 1\ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00279\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{00280\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ displacement\ =\ avg[i][j][0][0]\ +\ x\_lim\ -\/\ avg[i-\/1][k][0][0]}
\DoxyCodeLine{00281\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ abs(displacement)\ <\ d\_cutoff:}
\DoxyCodeLine{00282\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pbc\ =\ \textcolor{keyword}{True}}
\DoxyCodeLine{00283\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tracking\_objects[track\_ID].append([i-\/1,np.array([avg[i-\/1][k][0][0],\ avg[i-\/1][k][0][1],\ avg[i-\/1][k][0][2]]),int(pbc),avg[i-\/1][k][1]])\ \textcolor{comment}{\#\ first\ frame\ coordinates}}
\DoxyCodeLine{00284\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tracking\_objects[track\_ID].append([i,np.array([avg[i][j][0][0],\ avg[i][j][0][1],\ avg[i][j][0][2]]),int(pbc),avg[i][j][1]])\ \ \ \textcolor{comment}{\#\ second\ frame\ coordinates}}
\DoxyCodeLine{00285\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ track\_ID\ +=\ 1}
\DoxyCodeLine{00286\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00287\ \ \ \ \ \textcolor{comment}{\#\ For\ the\ remaining\ frames\ we\ compare\ the\ current\ x\ coordinate}}
\DoxyCodeLine{00288\ \ \ \ \ \textcolor{comment}{\#\ to\ those\ of\ the\ already\ existing\ objects}}
\DoxyCodeLine{00289\ \ \ \ \ \textcolor{keywordflow}{for}\ i\ \textcolor{keywordflow}{in}\ range(2,len(avg)):}
\DoxyCodeLine{00290\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ j\ \textcolor{keywordflow}{in}\ range(len(avg[i])):}
\DoxyCodeLine{00291\ \ \ \ \ \ \ \ \ \ \ \ \ d\_i\ =\ []}
\DoxyCodeLine{00292\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ obj\_ID,\ obj\ \textcolor{keywordflow}{in}\ tracking\_objects.items():}
\DoxyCodeLine{00293\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Calculate\ the\ distances\ between\ the\ current\ avg\ x\ position}}
\DoxyCodeLine{00294\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ and\ the\ last\ x\ position\ added\ to\ each\ tracking\ object}}
\DoxyCodeLine{00295\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dist\_1\ =\ avg[i][j][0][0]\ -\/\ obj[-\/1][1][0]}
\DoxyCodeLine{00296\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dist\_2\ =\ avg[i][j][0][0]\ +\ x\_lim\ -\/\ obj[-\/1][1][0]}
\DoxyCodeLine{00297\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dist\_3\ =\ avg[i][j][0][0]\ -\/\ x\_lim\ -\/\ obj[-\/1][1][0]}
\DoxyCodeLine{00298\ }
\DoxyCodeLine{00299\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Determine\ whether\ dislocation\ has\ crossed\ periodic\ boundary\ \ \ \ \ \ \ \ \ \ \ \ }}
\DoxyCodeLine{00300\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ abs(dist\_2)\ <\ abs(dist\_1)\ \textcolor{keywordflow}{and}\ abs(dist\_2)\ <\ abs(dist\_3):}
\DoxyCodeLine{00301\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dist\ =\ abs(dist\_2)}
\DoxyCodeLine{00302\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pbc\ =\ 1}
\DoxyCodeLine{00303\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{elif}\ abs(dist\_3)\ <\ abs(dist\_1)\ \textcolor{keywordflow}{and}\ abs(dist\_3)\ <\ abs(dist\_2):}
\DoxyCodeLine{00304\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dist\ =\ abs(dist\_3)}
\DoxyCodeLine{00305\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pbc\ =\ 3}
\DoxyCodeLine{00306\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{00307\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dist\ =\ abs(dist\_1)}
\DoxyCodeLine{00308\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pbc\ =\ 0}
\DoxyCodeLine{00309\ }
\DoxyCodeLine{00310\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ d\_i.append([avg[i][j][0][0],\ avg[i][j][0][1],\ avg[i][j][0][2],\ obj\_ID,\ dist,\ pbc])}
\DoxyCodeLine{00311\ }
\DoxyCodeLine{00312\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Append\ coordinate\ to\ corresponding\ dislocation}}
\DoxyCodeLine{00313\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Find\ the\ minimum\ distance\ between\ the\ current\ average\ position}}
\DoxyCodeLine{00314\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ and\ the\ average\ position\ in\ each\ dislocation\ in\ the\ previous\ frame}}
\DoxyCodeLine{00315\ \ \ \ \ \ \ \ \ \ \ \ \ d\_i\ =\ np.array(d\_i)}
\DoxyCodeLine{00316\ \ \ \ \ \ \ \ \ \ \ \ \ min\_dist\ =\ np.amin(d\_i,\ axis=0)[4]}
\DoxyCodeLine{00317\ \ \ \ \ \ \ \ \ \ \ \ \ indx\ =\ np.where(d\_i\ ==\ min\_dist)[0][0]}
\DoxyCodeLine{00318\ \ \ \ \ \ \ \ \ \ \ \ \ x\ =\ d\_i[indx][0]}
\DoxyCodeLine{00319\ \ \ \ \ \ \ \ \ \ \ \ \ y\ =\ d\_i[indx][1]}
\DoxyCodeLine{00320\ \ \ \ \ \ \ \ \ \ \ \ \ z\ =\ d\_i[indx][2]}
\DoxyCodeLine{00321\ \ \ \ \ \ \ \ \ \ \ \ \ pbc\ =\ int(d\_i[indx][5])}
\DoxyCodeLine{00322\ }
\DoxyCodeLine{00323\ \ \ \ \ \ \ \ \ \ \ \ \ tracking\_objects[indx].append([i,\ np.array([x,y,z]),\ pbc,\ avg[i][j][1]])}
\DoxyCodeLine{00324\ }
\DoxyCodeLine{00325\ \ \ \ \ \textcolor{comment}{\#\ Correct\ for\ PBCs}}
\DoxyCodeLine{00326\ \ \ \ \ pbcs\ =\ []}
\DoxyCodeLine{00327\ \ \ \ \ \textcolor{keywordflow}{for}\ i,\ object\ \textcolor{keywordflow}{in}\ tracking\_objects.items():}
\DoxyCodeLine{00328\ \ \ \ \ \ \ \ \ pbcs\_i\ =\ []}
\DoxyCodeLine{00329\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ j\ \textcolor{keywordflow}{in}\ range(len(object)):}
\DoxyCodeLine{00330\ \ \ \ \ \ \ \ \ \ \ \ \ pbcs\_i.append(object[j][2])}
\DoxyCodeLine{00331\ \ \ \ \ \ \ \ \ pbcs.append(np.array(pbcs\_i))}
\DoxyCodeLine{00332\ \ \ }
\DoxyCodeLine{00333\ \ \ \ \ starts\ =\ []}
\DoxyCodeLine{00334\ \ \ \ \ test\ =\ []}
\DoxyCodeLine{00335\ \ \ \ \ \textcolor{keywordflow}{for}\ pbc\ \textcolor{keywordflow}{in}\ pbcs:}
\DoxyCodeLine{00336\ \ \ \ \ \ \ \ \ starts.append(np.where(pbc\ ==\ 1)[0])}
\DoxyCodeLine{00337\ \ \ \ \ \ \ \ \ test.append(np.where(pbc\ ==3)[0])}
\DoxyCodeLine{00338\ }
\DoxyCodeLine{00339\ }
\DoxyCodeLine{00340\ \ \ \ \ \textcolor{keywordflow}{for}\ i,\ start\ \textcolor{keywordflow}{in}\ enumerate(starts):}
\DoxyCodeLine{00341\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ s\ \textcolor{keywordflow}{in}\ start:}
\DoxyCodeLine{00342\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ j\ \textcolor{keywordflow}{in}\ range(s,len(pbcs[i])):}
\DoxyCodeLine{00343\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tracking\_objects[i][j][1][0]\ +=\ x\_lim}
\DoxyCodeLine{00344\ }
\DoxyCodeLine{00345\ \ \ \ \ \textcolor{keywordflow}{for}\ i,\ start\ \textcolor{keywordflow}{in}\ enumerate(test):}
\DoxyCodeLine{00346\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ s\ \textcolor{keywordflow}{in}\ start:}
\DoxyCodeLine{00347\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ j\ \textcolor{keywordflow}{in}\ range(s,len(pbcs[i])):}
\DoxyCodeLine{00348\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tracking\_objects[i][j][1][0]\ -\/=\ x\_lim}
\DoxyCodeLine{00349\ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00350\ \ \ \ \ \textcolor{comment}{\#\ Collect\ position\ data\ after\ tracking}}
\DoxyCodeLine{00351\ \ \ \ \ position\ =\ []}
\DoxyCodeLine{00352\ \ \ \ \ vertices\ =\ []}
\DoxyCodeLine{00353\ \ \ \ \ t\ =\ []}
\DoxyCodeLine{00354\ \ \ \ \ \textcolor{keywordflow}{for}\ i,\ object\ \textcolor{keywordflow}{in}\ tracking\_objects.items():}
\DoxyCodeLine{00355\ \ \ \ \ \ \ \ \ position\_i\ =\ []}
\DoxyCodeLine{00356\ \ \ \ \ \ \ \ \ vertices\_i\ =\ []}
\DoxyCodeLine{00357\ \ \ \ \ \ \ \ \ t\_i\ =\ []}
\DoxyCodeLine{00358\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ j\ \textcolor{keywordflow}{in}\ range(len(object)):}
\DoxyCodeLine{00359\ \ \ \ \ \ \ \ \ \ \ \ \ position\_i.append(math.hypot(object[j][1][0]))}
\DoxyCodeLine{00360\ \ \ \ \ \ \ \ \ \ \ \ \ vertices\_i.append(object[j][3])}
\DoxyCodeLine{00361\ \ \ \ \ \ \ \ \ \ \ \ \ t\_i.append(object[j][0]*0.001*500)}
\DoxyCodeLine{00362\ \ \ \ \ \ \ \ \ position.append(position\_i)}
\DoxyCodeLine{00363\ \ \ \ \ \ \ \ \ vertices.append(vertices\_i)}
\DoxyCodeLine{00364\ \ \ \ \ \ \ \ \ t.append(t\_i)}
\DoxyCodeLine{00365\ }
\DoxyCodeLine{00366\ \ \ \ \ \textcolor{comment}{\#\ Change\ vertices\ from\ tuples\ to\ arrays\ for\ easier\ handling}}
\DoxyCodeLine{00367\ \ \ \ \ \textcolor{comment}{\#\ Sort\ vertices\ along\ y\ coords}}
\DoxyCodeLine{00368\ \ \ \ \ disloc\ =\ []}
\DoxyCodeLine{00369\ \ \ \ \ \textcolor{keywordflow}{for}\ i\ \textcolor{keywordflow}{in}\ range(len(vertices)):}
\DoxyCodeLine{00370\ \ \ \ \ \ \ \ \ frames\ =\ []}
\DoxyCodeLine{00371\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ j\ \textcolor{keywordflow}{in}\ range(len(vertices[i])):}
\DoxyCodeLine{00372\ \ \ \ \ \ \ \ \ \ \ \ \ vertex\ =\ []}
\DoxyCodeLine{00373\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ k\ \textcolor{keywordflow}{in}\ range(len(vertices[i][j])):}
\DoxyCodeLine{00374\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Wrap\ y}}
\DoxyCodeLine{00375\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ v\_x\ =\ vertices[i][j][k][0]}
\DoxyCodeLine{00376\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ v\_y\ =\ vertices[i][j][k][1]}
\DoxyCodeLine{00377\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ v\_z\ =\ vertices[i][j][k][2]\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00378\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ vertex.append([v\_x,\ v\_y,\ v\_z])}
\DoxyCodeLine{00379\ \ \ \ \ \ \ \ \ \ \ \ \ frames.append(sorted(vertex,\ key=\textcolor{keyword}{lambda}\ v:\ v[1]))}
\DoxyCodeLine{00380\ \ \ \ \ \ \ \ \ disloc.append(frames)}
\DoxyCodeLine{00381\ }
\DoxyCodeLine{00382\ \ \ \ \ \textcolor{comment}{\#\ Unwrap\ x\ to\ be\ consistent\ with\ average\ position\ data}}
\DoxyCodeLine{00383\ \ \ \ \ \textcolor{keywordflow}{for}\ i,\ start\ \textcolor{keywordflow}{in}\ enumerate(starts):}
\DoxyCodeLine{00384\ }
\DoxyCodeLine{00385\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ s\ \textcolor{keywordflow}{in}\ start:}
\DoxyCodeLine{00386\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ j\ \textcolor{keywordflow}{in}\ range(s,len(pbcs[i])):}
\DoxyCodeLine{00387\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ k\ \textcolor{keywordflow}{in}\ range(len(disloc[i][j])):}
\DoxyCodeLine{00388\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ disloc[i][j][k][0]\ +=\ x\_lim}
\DoxyCodeLine{00389\ }
\DoxyCodeLine{00390\ \ \ \ \ \textcolor{keywordflow}{return}\ position,\ disloc,\ t}

\end{DoxyCode}
\Hypertarget{namespacedislocation__analysis_a34abca717001b69ffaddd617df73d6e0}\label{namespacedislocation__analysis_a34abca717001b69ffaddd617df73d6e0} 
\index{dislocation\_analysis@{dislocation\_analysis}!wrap\_coords@{wrap\_coords}}
\index{wrap\_coords@{wrap\_coords}!dislocation\_analysis@{dislocation\_analysis}}
\doxysubsubsection{\texorpdfstring{wrap\_coords()}{wrap\_coords()}}
{\footnotesize\ttfamily wrap\+\_\+coords (\begin{DoxyParamCaption}\item[{}]{dislocation,  }\item[{}]{ax,  }\item[{}]{extent }\end{DoxyParamCaption})}

\begin{DoxyVerb}Function to wrap the coordinates of a dislocation line along a given axis.

Parameters
----------
dislocation : numpy.ndarray
              Dislocation line coordinates.
ax          : str
              "x", "y", or "z" - direction for wrapping.
extent      : float
              Cell length (in Angstroms) in direction of wrapping.

Returns
-------
numpy.ndarray
              Modified dislocation coordinates after wrapping.
\end{DoxyVerb}
 

Definition at line \mbox{\hyperlink{dislocation__analysis_8py_source_l00091}{91}} of file \mbox{\hyperlink{dislocation__analysis_8py_source}{dislocation\+\_\+analysis.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00091\ \textcolor{keyword}{def\ }wrap\_coords(dislocation,\ ax,\ extent):}
\DoxyCodeLine{00092\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{00093\ \textcolor{stringliteral}{\ \ \ \ Function\ to\ wrap\ the\ coordinates\ of\ a\ dislocation\ line\ along\ a\ given\ axis.}}
\DoxyCodeLine{00094\ \textcolor{stringliteral}{}}
\DoxyCodeLine{00095\ \textcolor{stringliteral}{\ \ \ \ Parameters}}
\DoxyCodeLine{00096\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00097\ \textcolor{stringliteral}{\ \ \ \ dislocation\ :\ numpy.ndarray}}
\DoxyCodeLine{00098\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Dislocation\ line\ coordinates.}}
\DoxyCodeLine{00099\ \textcolor{stringliteral}{\ \ \ \ ax\ \ \ \ \ \ \ \ \ \ :\ str}}
\DoxyCodeLine{00100\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ "{}x"{},\ "{}y"{},\ or\ "{}z"{}\ -\/\ direction\ for\ wrapping.}}
\DoxyCodeLine{00101\ \textcolor{stringliteral}{\ \ \ \ extent\ \ \ \ \ \ :\ float}}
\DoxyCodeLine{00102\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Cell\ length\ (in\ Angstroms)\ in\ direction\ of\ wrapping.}}
\DoxyCodeLine{00103\ \textcolor{stringliteral}{}}
\DoxyCodeLine{00104\ \textcolor{stringliteral}{\ \ \ \ Returns}}
\DoxyCodeLine{00105\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00106\ \textcolor{stringliteral}{\ \ \ \ numpy.ndarray}}
\DoxyCodeLine{00107\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Modified\ dislocation\ coordinates\ after\ wrapping.}}
\DoxyCodeLine{00108\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{00109\ \ \ \ \ \textcolor{keywordflow}{if}\ ax\ ==\ \textcolor{stringliteral}{"{}x"{}}:}
\DoxyCodeLine{00110\ \ \ \ \ \ \ \ \ j\ =\ 0}
\DoxyCodeLine{00111\ \ \ \ \ \textcolor{keywordflow}{elif}\ ax\ ==\ \textcolor{stringliteral}{"{}y"{}}:}
\DoxyCodeLine{00112\ \ \ \ \ \ \ \ \ j\ =\ 1}
\DoxyCodeLine{00113\ \ \ \ \ \textcolor{keywordflow}{elif}\ ax\ ==\ \textcolor{stringliteral}{"{}z"{}}:}
\DoxyCodeLine{00114\ \ \ \ \ \ \ \ \ j\ =\ 2}
\DoxyCodeLine{00115\ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{00116\ \ \ \ \ \ \ \ \ print(\textcolor{stringliteral}{"{}Error:\ ax\ must\ be\ set\ to\ 'x',\ 'y',\ or\ 'z'"{}})}
\DoxyCodeLine{00117\ \ \ \ \ \ \ \ \ sys.exit()}
\DoxyCodeLine{00118\ }
\DoxyCodeLine{00119\ \ \ \ \ \textcolor{keywordflow}{for}\ i\ \textcolor{keywordflow}{in}\ range(len(dislocation)):}
\DoxyCodeLine{00120\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ dislocation[i][j]\ <\ 0.0:}
\DoxyCodeLine{00121\ \ \ \ \ \ \ \ \ \ \ \ \ dislocation[i][j]\ =\ dislocation[i][j]\ +\ extent}
\DoxyCodeLine{00122\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ dislocation[i][j]\ >\ extent:}
\DoxyCodeLine{00123\ \ \ \ \ \ \ \ \ \ \ \ \ dislocation[i][j]\ =\ dislocation[i][j]\ -\/\ extent}
\DoxyCodeLine{00124\ \ \ \ \ }
\DoxyCodeLine{00125\ \ \ \ \ \textcolor{keywordflow}{return}\ dislocation}
\DoxyCodeLine{00126\ }

\end{DoxyCode}
\Hypertarget{namespacedislocation__analysis_ab7efed17b69b14fe72695ecdd14ca09b}\label{namespacedislocation__analysis_ab7efed17b69b14fe72695ecdd14ca09b} 
\index{dislocation\_analysis@{dislocation\_analysis}!write\_prop@{write\_prop}}
\index{write\_prop@{write\_prop}!dislocation\_analysis@{dislocation\_analysis}}
\doxysubsubsection{\texorpdfstring{write\_prop()}{write\_prop()}}
{\footnotesize\ttfamily write\+\_\+prop (\begin{DoxyParamCaption}\item[{}]{filename,  }\item[{}]{property,  }\item[{}]{time }\end{DoxyParamCaption})}

\begin{DoxyVerb}Function to write out a property time series
of a dislocation to a text file.

Parameters
----------
filename : str
           Output file name.
property : numpy.ndarray
           Property timeseries.
time     : numpy.ndarray
           Timesteps.
\end{DoxyVerb}
 

Definition at line \mbox{\hyperlink{dislocation__analysis_8py_source_l00204}{204}} of file \mbox{\hyperlink{dislocation__analysis_8py_source}{dislocation\+\_\+analysis.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00204\ \textcolor{keyword}{def\ }write\_prop(filename,\ property,\ time):}
\DoxyCodeLine{00205\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{00206\ \textcolor{stringliteral}{\ \ \ \ Function\ to\ write\ out\ a\ property\ time\ series}}
\DoxyCodeLine{00207\ \textcolor{stringliteral}{\ \ \ \ of\ a\ dislocation\ to\ a\ text\ file.}}
\DoxyCodeLine{00208\ \textcolor{stringliteral}{}}
\DoxyCodeLine{00209\ \textcolor{stringliteral}{\ \ \ \ Parameters}}
\DoxyCodeLine{00210\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00211\ \textcolor{stringliteral}{\ \ \ \ filename\ :\ str}}
\DoxyCodeLine{00212\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Output\ file\ name.}}
\DoxyCodeLine{00213\ \textcolor{stringliteral}{\ \ \ \ property\ :\ numpy.ndarray}}
\DoxyCodeLine{00214\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Property\ timeseries.}}
\DoxyCodeLine{00215\ \textcolor{stringliteral}{\ \ \ \ time\ \ \ \ \ :\ numpy.ndarray}}
\DoxyCodeLine{00216\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Timesteps.}}
\DoxyCodeLine{00217\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{00218\ \ \ \ \ f\ =\ open(f\textcolor{stringliteral}{"{}\{filename\}"{}},\ \textcolor{stringliteral}{"{}w"{}})}
\DoxyCodeLine{00219\ \ \ \ \ \textcolor{keywordflow}{for}\ i\ \textcolor{keywordflow}{in}\ range(len(property)):}
\DoxyCodeLine{00220\ \ \ \ \ \ \ \ \ f.write(f\textcolor{stringliteral}{"{}\{round(time[i],1)\}\ \ \ \ \ \{property[i]\}\ \(\backslash\)n"{}})}
\DoxyCodeLine{00221\ \ \ \ \ f.close()}
\DoxyCodeLine{00222\ }

\end{DoxyCode}
