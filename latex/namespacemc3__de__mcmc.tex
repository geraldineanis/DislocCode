\doxysection{mc3\+\_\+de\+\_\+mcmc Namespace Reference}
\hypertarget{namespacemc3__de__mcmc}{}\label{namespacemc3__de__mcmc}\index{mc3\_de\_mcmc@{mc3\_de\_mcmc}}


Script to run Differential Evolution Markov Chain Monte Carlo (DE-\/\+MC).  


\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{namespacemc3__de__mcmc_a864f85bd9175f281dde1d54106019151}{ODE\+\_\+solution}} (t)
\item 
\mbox{\hyperlink{namespacemc3__de__mcmc_a5619c74ce95a8ede9f11ebff7d728dcf}{x\+\_\+derivatives}} (x, t, c0, c1)
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Script to run Differential Evolution Markov Chain Monte Carlo (DE-\/\+MC). 

This script sets the settings need to run the $\text{MC}^3$ code to fit the parameters of the non-\/dimensional equation of motion $x\textnormal{\textquotesingle}\textnormal{\textquotesingle} + c_{0}x\textnormal{\textquotesingle} = c_{1}$ using the DE-\/\+MC algorithm (Braak and Vrugt, \href{https://doi.org/10.1007/s11222-008-9104-9}{\texttt{ https\+://doi.\+org/10.\+1007/s11222-\/008-\/9104-\/9}}). The full $\text{MC}^3$ code documentation including a detailed description of the settings used below can be found at \href{https://mc3.readthedocs.io/en/latest/mcmc_tutorial.html}{\texttt{ https\+://mc3.\+readthedocs.\+io/en/latest/mcmc\+\_\+tutorial.\+html}}.

The script reads in the dislocation position vs. time data obtained by post-\/processing LAMMPS MD trajectories and uses DE-\/\+MC to fit the parameters of the above equation of motion. A directory should be set by setting the out\+\_\+dir variable, where the DE-\/\+MC output can be stored. The scripts, \doxylink{de__mc__analysis_8py}{de\+\_\+mc\+\_\+analysis.\+py} and m\+BF\+\_\+new.\+py, can be used to analyze the results of the fitting procedure, which give the parameter marginal and joint posterior distributions. In addition to parameter distributions, other outputs of the analysis scripts include trace plots and parameter mean and standard deviation convergence with DE-\/\+MC generation (iteration), which can be used for further optimisation of the DE-\/\+MC settings provided here.

The script m\+BF\+\_\+new.\+py provides plotting tools, which can ve used to produce additional plots other than those generated by the $\text{MC}^3$ code (these can be found in the output directory set at the beginning of this script). The de\+\_\+mcmc.\+npz file contains the DE\+\_\+\+MC accepted samples and is used for further analysis, while the de\+\_\+mcmc.\+log and de\+\_\+mcmc\+\_\+statistics.\+txt files contain a summary of the DE-\/\+MC fitting procedure output. These files can also be found in the user-\/set directory defined in this script.

\begin{DoxySeeAlso}{See also}

\end{DoxySeeAlso}
\doxylink{dislocation__script_8py}{dislocation\+\_\+script.\+py}

m\+BF\+\_\+new.\+py 

\doxysubsection{Function Documentation}
\Hypertarget{namespacemc3__de__mcmc_a864f85bd9175f281dde1d54106019151}\label{namespacemc3__de__mcmc_a864f85bd9175f281dde1d54106019151} 
\index{mc3\_de\_mcmc@{mc3\_de\_mcmc}!ODE\_solution@{ODE\_solution}}
\index{ODE\_solution@{ODE\_solution}!mc3\_de\_mcmc@{mc3\_de\_mcmc}}
\doxysubsubsection{\texorpdfstring{ODE\_solution()}{ODE\_solution()}}
{\footnotesize\ttfamily ODE\+\_\+solution (\begin{DoxyParamCaption}\item[{}]{t }\end{DoxyParamCaption})}

\begin{DoxyVerb}Solves the differential equation x" + c0*x' = c1

Parameters
----------
t : numpy.ndarray
    Vector of fitting parameters
\end{DoxyVerb}
 

Definition at line \mbox{\hyperlink{mc3__de__mcmc_8py_source_l00099}{99}} of file \mbox{\hyperlink{mc3__de__mcmc_8py_source}{mc3\+\_\+de\+\_\+mcmc.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00099\ \textcolor{keyword}{def\ }ODE\_solution(t):}
\DoxyCodeLine{00100\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{00101\ \textcolor{stringliteral}{\ \ \ \ Solves\ the\ differential\ equation\ x"{}\ +\ c0*x'\ =\ c1}}
\DoxyCodeLine{00102\ \textcolor{stringliteral}{}}
\DoxyCodeLine{00103\ \textcolor{stringliteral}{\ \ \ \ Parameters}}
\DoxyCodeLine{00104\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00105\ \textcolor{stringliteral}{\ \ \ \ t\ :\ numpy.ndarray}}
\DoxyCodeLine{00106\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Vector\ of\ fitting\ parameters}}
\DoxyCodeLine{00107\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{00108\ \ \ \ \ c0,\ c1\ =\ t\ \ \textcolor{comment}{\#\ Unpack\ parameters}}
\DoxyCodeLine{00109\ \ \ \ \ position,\ velocity\ =\ odeint(x\_derivatives,\ x0,\ t\_data,\ args=(c0,c1)).T}
\DoxyCodeLine{00110\ \ \ \ \ \textcolor{keywordflow}{return}\ position}
\DoxyCodeLine{00111\ }
\DoxyCodeLine{00112\ \textcolor{comment}{\#\ MC3\ settings}}
\DoxyCodeLine{00113\ }
\DoxyCodeLine{00114\ \textcolor{comment}{\#\ Input\ data}}

\end{DoxyCode}
\Hypertarget{namespacemc3__de__mcmc_a5619c74ce95a8ede9f11ebff7d728dcf}\label{namespacemc3__de__mcmc_a5619c74ce95a8ede9f11ebff7d728dcf} 
\index{mc3\_de\_mcmc@{mc3\_de\_mcmc}!x\_derivatives@{x\_derivatives}}
\index{x\_derivatives@{x\_derivatives}!mc3\_de\_mcmc@{mc3\_de\_mcmc}}
\doxysubsubsection{\texorpdfstring{x\_derivatives()}{x\_derivatives()}}
{\footnotesize\ttfamily x\+\_\+derivatives (\begin{DoxyParamCaption}\item[{}]{x,  }\item[{}]{t,  }\item[{}]{c0,  }\item[{}]{c1 }\end{DoxyParamCaption})}

\begin{DoxyVerb}Defines the derivatives needed to solve the non-dimensional equation of motion x" + c0*x' = c1

Parameters
----------
x  : numpy.ndarray 
     LHS row vector (dependent variable)
t  : numpy.ndarray
     Time (the independent variable)
c0 : float
     Non-dimensional parameter - B/m
c1  : float
     Non-dimensional parameter - F/m
Returns
-------
numpy.ndarray
      Derrivates.
\end{DoxyVerb}
 

Definition at line \mbox{\hyperlink{mc3__de__mcmc_8py_source_l00074}{74}} of file \mbox{\hyperlink{mc3__de__mcmc_8py_source}{mc3\+\_\+de\+\_\+mcmc.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00074\ \textcolor{keyword}{def\ }x\_derivatives(x,t,c0,c1):}
\DoxyCodeLine{00075\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{00076\ \textcolor{stringliteral}{\ \ \ \ Defines\ the\ derivatives\ needed\ to\ solve\ the\ non-\/dimensional\ equation\ of\ motion\ x"{}\ +\ c0*x'\ =\ c1}}
\DoxyCodeLine{00077\ \textcolor{stringliteral}{\ \ \ \ }}
\DoxyCodeLine{00078\ \textcolor{stringliteral}{\ \ \ \ Parameters}}
\DoxyCodeLine{00079\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00080\ \textcolor{stringliteral}{\ \ \ \ x\ \ :\ numpy.ndarray\ }}
\DoxyCodeLine{00081\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ LHS\ row\ vector\ (dependent\ variable)}}
\DoxyCodeLine{00082\ \textcolor{stringliteral}{\ \ \ \ t\ \ :\ numpy.ndarray}}
\DoxyCodeLine{00083\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ Time\ (the\ independent\ variable)}}
\DoxyCodeLine{00084\ \textcolor{stringliteral}{\ \ \ \ c0\ :\ float}}
\DoxyCodeLine{00085\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ Non-\/dimensional\ parameter\ -\/\ B/m}}
\DoxyCodeLine{00086\ \textcolor{stringliteral}{\ \ \ \ c1\ \ :\ float}}
\DoxyCodeLine{00087\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ Non-\/dimensional\ parameter\ -\/\ F/m}}
\DoxyCodeLine{00088\ \textcolor{stringliteral}{\ \ \ \ Returns}}
\DoxyCodeLine{00089\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00090\ \textcolor{stringliteral}{\ \ \ \ numpy.ndarray}}
\DoxyCodeLine{00091\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ Derrivates.}}
\DoxyCodeLine{00092\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{00093\ \ \ \ \ dxdt\ =\ [x[1],\ np.exp(c1)-\/\ np.exp(c0)*x[1]]}
\DoxyCodeLine{00094\ \ \ \ \ \textcolor{keywordflow}{return}\ dxdt}
\DoxyCodeLine{00095\ }
\DoxyCodeLine{00096\ \textcolor{comment}{\#\ Set\ the\ initial\ conditions\ -\/\ initial\ position\ and\ velocity}}

\end{DoxyCode}
