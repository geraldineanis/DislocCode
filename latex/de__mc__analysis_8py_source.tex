\doxysection{de\+\_\+mc\+\_\+analysis.\+py}
\hypertarget{de__mc__analysis_8py_source}{}\label{de__mc__analysis_8py_source}\index{de\_mcmc/de\_mc\_analysis.py@{de\_mcmc/de\_mc\_analysis.py}}
\mbox{\hyperlink{de__mc__analysis_8py}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{de__mc__analysis_8py_source_l00001}\mbox{\hyperlink{namespacede__mc__analysis}{00001}}\ \textcolor{stringliteral}{"{}"{}"{}!\ @ref}}
\DoxyCodeLine{\Hypertarget{de__mc__analysis_8py_source_l00002}00002\ \textcolor{stringliteral}{Script\ to\ analyse\ the\ ouput\ from\ the\ parameter\ fitting\ using\ DE-\/MC.}}
\DoxyCodeLine{\Hypertarget{de__mc__analysis_8py_source_l00003}00003\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{de__mc__analysis_8py_source_l00004}00004\ \textcolor{stringliteral}{This\ script\ uses\ the\ functions\ contained\ in\ the\ funcs.py\ module\ to:}}
\DoxyCodeLine{\Hypertarget{de__mc__analysis_8py_source_l00005}00005\ \textcolor{stringliteral}{-\/\ Calculate\ relevant\ parameter\ statistics\ using\ accepted\ samples\ obtained\ from\ fitting\ using\ DE-\/MC.}}
\DoxyCodeLine{\Hypertarget{de__mc__analysis_8py_source_l00006}00006\ \textcolor{stringliteral}{-\/\ Visualise\ the\ DE-\/MC\ output\ as\ well\ as\ the\ marginal\ and\ joint\ parameter\ posterior\ distributions.}}
\DoxyCodeLine{\Hypertarget{de__mc__analysis_8py_source_l00007}00007\ \textcolor{stringliteral}{-\/\ Produce\ a\ trace\ plot\ and\ parameter\ mean\ and\ convergence\ with\ DE-\/MC\ generation\ (iteration)\ to\ guage\ the\ convergence}}
\DoxyCodeLine{\Hypertarget{de__mc__analysis_8py_source_l00008}00008\ \textcolor{stringliteral}{\ \ of\ the\ DE-\/MC.}}
\DoxyCodeLine{\Hypertarget{de__mc__analysis_8py_source_l00009}00009\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{de__mc__analysis_8py_source_l00010}00010\ \textcolor{stringliteral}{The\ function,\ stat\_convergence,\ takes\ a\ long\ time\ to\ run.\ Accordingly,\ it\ is\ recommended\ that\ it\ is\ run\ only\ once,\ }}
\DoxyCodeLine{\Hypertarget{de__mc__analysis_8py_source_l00011}00011\ \textcolor{stringliteral}{and\ its\ output\ can\ be\ written\ to\ a\ text\ file\ by\ setting\ write\_out=True\ in\ the\ function\ argument\ for\ further\ analysis.}}
\DoxyCodeLine{\Hypertarget{de__mc__analysis_8py_source_l00012}00012\ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{de__mc__analysis_8py_source_l00013}00013\ \textcolor{keyword}{import}\ numpy\ \textcolor{keyword}{as}\ np}
\DoxyCodeLine{\Hypertarget{de__mc__analysis_8py_source_l00014}00014\ \textcolor{keyword}{from}\ funcs\ \textcolor{keyword}{import}\ *}
\DoxyCodeLine{\Hypertarget{de__mc__analysis_8py_source_l00015}00015\ }
\DoxyCodeLine{\Hypertarget{de__mc__analysis_8py_source_l00016}00016\ \textcolor{comment}{\#\ Read\ in\ and\ non-\/dimnesionalise\ dislocation\ position-\/time\ data}}
\DoxyCodeLine{\Hypertarget{de__mc__analysis_8py_source_l00017}\mbox{\hyperlink{namespacede__mc__analysis_a511ae0b1c13f95e5f08f1a0dd3da3d93}{00017}}\ data\ =\ np.loadtxt(\textcolor{stringliteral}{"{}perfect\_pos.txt"{}})\ \ \ }
\DoxyCodeLine{\Hypertarget{de__mc__analysis_8py_source_l00018}00018\ \textcolor{comment}{\#\ Number\ of\ points\ to\ discard\ at\ beginning\ of\ trajectory}}
\DoxyCodeLine{\Hypertarget{de__mc__analysis_8py_source_l00019}00019\ \textcolor{comment}{\#\ Make\ sure\ this\ matches\ the\ number\ that\ was\ given\ in\ the\ mc3\_de\_mcmc.py\ script}}
\DoxyCodeLine{\Hypertarget{de__mc__analysis_8py_source_l00020}\mbox{\hyperlink{namespacede__mc__analysis_a76f11d9a0a47b94f72c2d0e77fb32240}{00020}}\ n\ =\ 7}
\DoxyCodeLine{\Hypertarget{de__mc__analysis_8py_source_l00021}00021\ }
\DoxyCodeLine{\Hypertarget{de__mc__analysis_8py_source_l00022}00022\ \textcolor{keywordflow}{if}\ n\ ==\ 0:}
\DoxyCodeLine{\Hypertarget{de__mc__analysis_8py_source_l00023}00023\ \ \ \ \ \textcolor{comment}{\#\ time}}
\DoxyCodeLine{\Hypertarget{de__mc__analysis_8py_source_l00024}\mbox{\hyperlink{namespacede__mc__analysis_aed39282eeeb6b1970c1ce27485e91afe}{00024}}\ \ \ \ \ t\_data\ =\ data[:,0]}
\DoxyCodeLine{\Hypertarget{de__mc__analysis_8py_source_l00025}\mbox{\hyperlink{namespacede__mc__analysis_a5d751bacdd9e4d26d056f5398ae4246e}{00025}}\ \ \ \ \ t\_range\ =\ np.ptp(t\_data)}
\DoxyCodeLine{\Hypertarget{de__mc__analysis_8py_source_l00026}00026\ \ \ \ \ t\_data\ =\ data[:,0]/t\_range}
\DoxyCodeLine{\Hypertarget{de__mc__analysis_8py_source_l00027}00027\ \ \ \ \ \textcolor{comment}{\#\ position\ data}}
\DoxyCodeLine{\Hypertarget{de__mc__analysis_8py_source_l00028}\mbox{\hyperlink{namespacede__mc__analysis_a5637c0fc79271593e595e5f5a28a042e}{00028}}\ \ \ \ \ x\_data\ =\ 0.1*data[:,1]\ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Convert\ from\ Angstroms\ to\ nm}}
\DoxyCodeLine{\Hypertarget{de__mc__analysis_8py_source_l00029}\mbox{\hyperlink{namespacede__mc__analysis_a5a4e70aef1b59c2077e838835e0ad13c}{00029}}\ \ \ \ \ x\_range\ =\ np.ptp(x\_data)}
\DoxyCodeLine{\Hypertarget{de__mc__analysis_8py_source_l00030}\mbox{\hyperlink{namespacede__mc__analysis_a39291e1e7c5545a7b8a9c64b89d973f9}{00030}}\ \ \ \ \ xi\ =\ x\_data[0]}
\DoxyCodeLine{\Hypertarget{de__mc__analysis_8py_source_l00031}00031\ \ \ \ \ x\_data\ =\ (x\_data-\/xi)/x\_range}
\DoxyCodeLine{\Hypertarget{de__mc__analysis_8py_source_l00032}00032\ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{de__mc__analysis_8py_source_l00033}00033\ \ \ \ \ \textcolor{comment}{\#\ time}}
\DoxyCodeLine{\Hypertarget{de__mc__analysis_8py_source_l00034}00034\ \ \ \ \ t\_data\ =\ data[:-\/n,0]}
\DoxyCodeLine{\Hypertarget{de__mc__analysis_8py_source_l00035}00035\ \ \ \ \ t\_range\ =\ np.ptp(t\_data)}
\DoxyCodeLine{\Hypertarget{de__mc__analysis_8py_source_l00036}00036\ \ \ \ \ t\_data\ =\ data[:-\/n,0]/t\_range}
\DoxyCodeLine{\Hypertarget{de__mc__analysis_8py_source_l00037}00037\ \ \ \ \ \textcolor{comment}{\#\ position\ data}}
\DoxyCodeLine{\Hypertarget{de__mc__analysis_8py_source_l00038}00038\ \ \ \ \ x\_data\ =\ 0.1*data[n:,1]\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Convert\ from\ Angstroms\ to\ nm}}
\DoxyCodeLine{\Hypertarget{de__mc__analysis_8py_source_l00039}00039\ \ \ \ \ x\_range\ =\ np.ptp(x\_data)}
\DoxyCodeLine{\Hypertarget{de__mc__analysis_8py_source_l00040}00040\ \ \ \ \ xi\ =\ x\_data[0]}
\DoxyCodeLine{\Hypertarget{de__mc__analysis_8py_source_l00041}00041\ \ \ \ \ x\_data\ =\ (x\_data-\/xi)/x\_range}
\DoxyCodeLine{\Hypertarget{de__mc__analysis_8py_source_l00042}00042\ }
\DoxyCodeLine{\Hypertarget{de__mc__analysis_8py_source_l00043}00043\ \textcolor{comment}{\#\ DE-\/MCMC\ results}}
\DoxyCodeLine{\Hypertarget{de__mc__analysis_8py_source_l00044}\mbox{\hyperlink{namespacede__mc__analysis_a640ebad51b0795fbf7b4ec2e44b5ece5}{00044}}\ n\_samples\ =\ int(1e6)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Number\ of\ DE-\/MC\ iterations}}
\DoxyCodeLine{\Hypertarget{de__mc__analysis_8py_source_l00045}00045\ \textcolor{comment}{\#\ Number\ of\ accepted\ samples\ to\ discard}}
\DoxyCodeLine{\Hypertarget{de__mc__analysis_8py_source_l00046}00046\ \textcolor{comment}{\#\ Run\ this\ script\ once\ and\ determine\ based\ on\ trace\ plot}}
\DoxyCodeLine{\Hypertarget{de__mc__analysis_8py_source_l00047}\mbox{\hyperlink{namespacede__mc__analysis_a3d843ba517b7a9e462deec3861eeafcd}{00047}}\ burn\ =\ int(1e5)}
\DoxyCodeLine{\Hypertarget{de__mc__analysis_8py_source_l00048}00048\ \textcolor{comment}{\#\ Fitting\ parameters\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }}
\DoxyCodeLine{\Hypertarget{de__mc__analysis_8py_source_l00049}\mbox{\hyperlink{namespacede__mc__analysis_a426852633d2045ae6b1f25f7efdaac11}{00049}}\ dims\ =\ 2}
\DoxyCodeLine{\Hypertarget{de__mc__analysis_8py_source_l00050}\mbox{\hyperlink{namespacede__mc__analysis_a41000f175dc0115080e2a682cc06dbe9}{00050}}\ params\ =\ [\textcolor{stringliteral}{r"{}\$c\_\{0\}\$"{}},\ \textcolor{stringliteral}{r"{}\$c\_\{1\}\$"{}}]}
\DoxyCodeLine{\Hypertarget{de__mc__analysis_8py_source_l00051}\mbox{\hyperlink{namespacede__mc__analysis_ac7d442f1eb09e22e9442a4a02ac9ac21}{00051}}\ log\_params\ =\ [\textcolor{stringliteral}{r"{}ln(\$c\_\{0\}\$)"{}},\ \textcolor{stringliteral}{r"{}ln(\$c\_\{1\}\$)"{}}]}
\DoxyCodeLine{\Hypertarget{de__mc__analysis_8py_source_l00052}00052\ }
\DoxyCodeLine{\Hypertarget{de__mc__analysis_8py_source_l00053}\mbox{\hyperlink{namespacede__mc__analysis_a899d3aff6fc24618b39966171b723bcd}{00053}}\ prior\ =\ \ \ \ np.array([0.0,\ 0.0])\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ parameters\ mean\ vector}}
\DoxyCodeLine{\Hypertarget{de__mc__analysis_8py_source_l00054}\mbox{\hyperlink{namespacede__mc__analysis_a93a86e854a239e6d7bbde96c61637177}{00054}}\ priorlow\ =\ np.array([2.0,\ 2.0])\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ parameters\ -\/1*sigma\ }}
\DoxyCodeLine{\Hypertarget{de__mc__analysis_8py_source_l00055}\mbox{\hyperlink{namespacede__mc__analysis_a132873269d56c3eb204d496ae2011110}{00055}}\ priorup\ =\ \ np.array([2.0,\ 2.0])\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ parameters\ +1*sigma}}
\DoxyCodeLine{\Hypertarget{de__mc__analysis_8py_source_l00056}00056\ }
\DoxyCodeLine{\Hypertarget{de__mc__analysis_8py_source_l00057}00057\ \textcolor{comment}{\#\ Set\ the\ directory\ where\ the\ DE-\/MC\ output\ files\ are\ stored}}
\DoxyCodeLine{\Hypertarget{de__mc__analysis_8py_source_l00058}\mbox{\hyperlink{namespacede__mc__analysis_af3c2c270199fd3662cdaa096853aae60}{00058}}\ out\_dir\ =\ f\textcolor{stringliteral}{"{}de\_mc\_out"{}}}
\DoxyCodeLine{\Hypertarget{de__mc__analysis_8py_source_l00059}00059\ data\ =\ np.load(f\textcolor{stringliteral}{"{}./\{out\_dir\}/de\_mcmc.npz"{}})}
\DoxyCodeLine{\Hypertarget{de__mc__analysis_8py_source_l00060}00060\ }
\DoxyCodeLine{\Hypertarget{de__mc__analysis_8py_source_l00061}00061\ print(f\textcolor{stringliteral}{"{}Remaining\ samples\ =\ \{n\_samples-\/burn\}"{}})}
\DoxyCodeLine{\Hypertarget{de__mc__analysis_8py_source_l00062}00062\ }
\DoxyCodeLine{\Hypertarget{de__mc__analysis_8py_source_l00063}00063\ \textcolor{comment}{\#\ Note:\ work\ with\ logs\ of\ data\ -\/\ log(c\_i)\ \string~\ Normal}}
\DoxyCodeLine{\Hypertarget{de__mc__analysis_8py_source_l00064}00064\ \textcolor{comment}{\#\ The\ model\ is\ set\ up\ such\ that\ the\ we\ sample\ log(c\_i)}}
\DoxyCodeLine{\Hypertarget{de__mc__analysis_8py_source_l00065}\mbox{\hyperlink{namespacede__mc__analysis_acd9e1b0682bd285ded3d808e850700c8}{00065}}\ log\_c,\ log\_c\_mean,\ post\_cov,\ log\_c\_std\ =\ \mbox{\hyperlink{namespacefuncs_a5737b8a61a3f2ecfbd0e9890fa7bc5c0}{get\_posterior}}(data,\ n\_samples,\ burn,\ dims)}
\DoxyCodeLine{\Hypertarget{de__mc__analysis_8py_source_l00066}00066\ }
\DoxyCodeLine{\Hypertarget{de__mc__analysis_8py_source_l00067}00067\ print(\textcolor{stringliteral}{"{}Parameter\ Means"{}},\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}},\ log\_c\_mean)}
\DoxyCodeLine{\Hypertarget{de__mc__analysis_8py_source_l00068}00068\ print(\textcolor{stringliteral}{"{}Standard\ dev."{}},\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}},\ log\_c\_std)}
\DoxyCodeLine{\Hypertarget{de__mc__analysis_8py_source_l00069}00069\ print(\textcolor{stringliteral}{"{}Posterior\ Covariance\ Matrix"{}},\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}},\ post\_cov)}
\DoxyCodeLine{\Hypertarget{de__mc__analysis_8py_source_l00070}00070\ }
\DoxyCodeLine{\Hypertarget{de__mc__analysis_8py_source_l00071}00071\ \textcolor{comment}{\#\ Write\ summary}}
\DoxyCodeLine{\Hypertarget{de__mc__analysis_8py_source_l00072}\mbox{\hyperlink{namespacede__mc__analysis_a0a9e9c5c3eae62014f8951f1c926fd22}{00072}}\ filename\ =\ \textcolor{stringliteral}{"{}de\_mc\_summary.txt"{}}}
\DoxyCodeLine{\Hypertarget{de__mc__analysis_8py_source_l00073}00073\ \mbox{\hyperlink{namespacefuncs_a74b5578dcc03f31a7cd7fe1d9ac74305}{write\_demc\_summary}}(filename,\ n\_samples,\ burn,\ log\_c\_mean,\ log\_c\_std,\ post\_cov)}
\DoxyCodeLine{\Hypertarget{de__mc__analysis_8py_source_l00074}00074\ }
\DoxyCodeLine{\Hypertarget{de__mc__analysis_8py_source_l00075}00075\ \textcolor{comment}{\#\ Plots}}
\DoxyCodeLine{\Hypertarget{de__mc__analysis_8py_source_l00076}00076\ \textcolor{comment}{\#\ Trace\ plots}}
\DoxyCodeLine{\Hypertarget{de__mc__analysis_8py_source_l00077}\mbox{\hyperlink{namespacede__mc__analysis_a53a9b7aa07c149779cad676cdf07b4f7}{00077}}\ \mbox{\hyperlink{namespacefuncs_a395964f7cb35a51200f65747977f5128}{plot\_trace}}(dims,burn,log\_c,params,save\_plt=\textcolor{keyword}{True},show\_plt=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{de__mc__analysis_8py_source_l00078}00078\ }
\DoxyCodeLine{\Hypertarget{de__mc__analysis_8py_source_l00079}00079\ \textcolor{comment}{\#\ Pairplot}}
\DoxyCodeLine{\Hypertarget{de__mc__analysis_8py_source_l00080}00080\ \mbox{\hyperlink{namespacefuncs_ac0b38e88d85e3ed558efd8d03c8d6b8c}{plot\_pairplot}}(log\_c,log\_params,save\_plt=\textcolor{keyword}{True},show\_plt=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{de__mc__analysis_8py_source_l00081}00081\ }
\DoxyCodeLine{\Hypertarget{de__mc__analysis_8py_source_l00082}00082\ \textcolor{comment}{\#\ Marginal\ parameter\ posterior\ disributions}}
\DoxyCodeLine{\Hypertarget{de__mc__analysis_8py_source_l00083}\mbox{\hyperlink{namespacede__mc__analysis_aa3b7b7485467046f9ac6f242bb6280d4}{00083}}\ d\_range\ =\ np.linspace(-\/10.0,\ 10.0,\ 1001)}
\DoxyCodeLine{\Hypertarget{de__mc__analysis_8py_source_l00084}00084\ \mbox{\hyperlink{namespacefuncs_a9a683cda2e20b739f342badfc963b018}{plot\_marginal}}(dims,log\_c,log\_c\_mean,log\_c\_std,prior,priorlow,d\_range,log\_params,save\_plt=\textcolor{keyword}{True},show\_plt=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{de__mc__analysis_8py_source_l00085}00085\ }
\DoxyCodeLine{\Hypertarget{de__mc__analysis_8py_source_l00086}00086\ \textcolor{comment}{\#\ Convergence\ of\ mean\ and\ standard\ devs\ with\ generation}}
\DoxyCodeLine{\Hypertarget{de__mc__analysis_8py_source_l00087}00087\ \textcolor{comment}{\#\ This\ takes\ a\ very\ long\ time\ to\ run\ (for\ 1e6\ iterations\ \string~\ 1h)}}
\DoxyCodeLine{\Hypertarget{de__mc__analysis_8py_source_l00088}00088\ \textcolor{comment}{\#\ To\ run,\ uncomment\ the\ following\ line}}
\DoxyCodeLine{\Hypertarget{de__mc__analysis_8py_source_l00089}00089\ \textcolor{comment}{\#\ means,\ std\_devs\ =\ stat\_convergence(log\_c,\ dims,\ write\_out=True)}}

\end{DoxyCode}
