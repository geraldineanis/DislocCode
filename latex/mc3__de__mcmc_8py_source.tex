\doxysection{mc3\+\_\+de\+\_\+mcmc.\+py}
\hypertarget{mc3__de__mcmc_8py_source}{}\label{mc3__de__mcmc_8py_source}\index{de\_mcmc/mc3\_de\_mcmc.py@{de\_mcmc/mc3\_de\_mcmc.py}}
\mbox{\hyperlink{mc3__de__mcmc_8py}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00001}\mbox{\hyperlink{namespacemc3__de__mcmc}{00001}}\ \textcolor{stringliteral}{"{}"{}"{}!\ @ref}}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00002}00002\ \textcolor{stringliteral}{Script\ to\ run\ Differential\ Evolution\ Markov\ Chain\ Monte\ Carlo\ (DE-\/MC).}}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00003}00003\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00004}00004\ \textcolor{stringliteral}{This\ script\ sets\ the\ settings\ need\ to\ run\ the\ \(\backslash\)f\$\(\backslash\)text\{MC\}\string^3\(\backslash\)f\$\ code\ to\ fit\ the\ parameters\ of\ the\ non-\/dimensional\ equation\ of\ motion\ \(\backslash\)f\$x''\ +\ c\_\{0\}x'\ =\ c\_\{1\}\(\backslash\)f\$\ using\ the\ DE-\/MC\ algorithm\ }}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00005}00005\ \textcolor{stringliteral}{(Braak\ and\ Vrugt,\ https://doi.org/10.1007/s11222-\/008-\/9104-\/9).\ The\ full\ \(\backslash\)f\$\(\backslash\)text\{MC\}\string^3\(\backslash\)f\$\ code\ documentation\ including\ a\ detailed\ description\ of\ the\ settings\ used\ below\ can\ be\ found\ at\ }}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00006}00006\ \textcolor{stringliteral}{https://mc3.readthedocs.io/en/latest/mcmc\_tutorial.html.}}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00007}00007\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00008}00008\ \textcolor{stringliteral}{The\ script\ reads\ in\ the\ dislocation\ position\ vs.\ time\ data\ obtained\ by\ post-\/processing\ LAMMPS\ MD\ trajectories\ and\ uses\ DE-\/MC\ to\ fit\ the\ parameters\ of\ the\ above\ equation\ of\ motion.\ A}}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00009}00009\ \textcolor{stringliteral}{directory\ should\ be\ set\ by\ setting\ the\ out\_dir\ variable,\ where\ the\ DE-\/MC\ output\ can\ be\ stored.\ The\ scripts,\ de\_mc\_analysis.py\ and\ mBF\_new.py,\ can\ be\ used\ to\ analyze\ the\ results\ of\ the\ }}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00010}00010\ \textcolor{stringliteral}{fitting\ procedure,\ which\ give\ the\ parameter\ marginal\ and\ joint\ posterior\ distributions.\ In\ addition\ to\ parameter\ distributions,\ other\ outputs\ of\ the\ analysis\ scripts\ include\ trace\ plots\ and\ parameter\ mean\ and\ }}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00011}00011\ \textcolor{stringliteral}{standard\ deviation\ convergence\ with\ DE-\/MC\ generation\ (iteration),\ which\ can\ be\ used\ for\ further\ optimisation\ of\ the\ DE-\/MC\ settings\ provided\ here.}}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00012}00012\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00013}00013\ \textcolor{stringliteral}{The\ script\ mBF\_new.py\ provides\ plotting\ tools,\ which\ can\ ve\ used\ to\ produce\ additional\ plots\ other\ than\ those\ generated\ by\ the\ \(\backslash\)f\$\(\backslash\)text\{MC\}\string^3\(\backslash\)f\$\ code\ (these\ can\ be\ found\ in\ the\ output\ directory\ }}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00014}00014\ \textcolor{stringliteral}{set\ at\ the\ beginning\ of\ this\ script).\ The\ de\_mcmc.npz\ file\ contains\ the\ DE\_MC\ accepted\ samples\ and\ is\ used\ for\ further\ analysis,\ while\ the\ de\_mcmc.log\ and\ de\_mcmc\_statistics.txt\ files\ contain\ }}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00015}00015\ \textcolor{stringliteral}{a\ summary\ of\ the\ DE-\/MC\ fitting\ procedure\ output.\ These\ files\ can\ also\ be\ found\ in\ the\ user-\/set\ directory\ defined\ in\ this\ script.}}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00016}00016\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00017}00017\ \textcolor{stringliteral}{@sa}}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00018}00018\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00019}00019\ \textcolor{stringliteral}{dislocation\_script.py}}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00020}00020\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00021}00021\ \textcolor{stringliteral}{mBF\_new.py}}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00022}00022\ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00023}00023\ }
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00024}00024\ \textcolor{keyword}{import}\ numpy\ \textcolor{keyword}{as}\ np}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00025}00025\ \textcolor{keyword}{import}\ seaborn\ \textcolor{keyword}{as}\ sns}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00026}00026\ \textcolor{keyword}{from}\ scipy.integrate\ \textcolor{keyword}{import}\ odeint}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00027}00027\ \textcolor{keyword}{from}\ scipy.optimize\ \textcolor{keyword}{import}\ minimize}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00028}00028\ \textcolor{keyword}{import}\ scipy.stats\ \textcolor{keyword}{as}\ st}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00029}00029\ \textcolor{keyword}{from}\ matplotlib\ \textcolor{keyword}{import}\ pyplot\ \textcolor{keyword}{as}\ plt}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00030}00030\ \textcolor{keyword}{import}\ pandas\ \textcolor{keyword}{as}\ pd}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00031}00031\ \textcolor{keyword}{import}\ mc3}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00032}00032\ \textcolor{keyword}{import}\ os}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00033}00033\ }
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00034}00034\ \textcolor{comment}{\#\ Set\ directory\ to\ store\ DE-\/MC\ ouput\ files}}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00035}\mbox{\hyperlink{namespacemc3__de__mcmc_af3c2c270199fd3662cdaa096853aae60}{00035}}\ out\_dir\ =\ \textcolor{stringliteral}{"{}de\_mc\_out"{}}}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00036}00036\ }
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00037}00037\ }
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00038}00038\ \textcolor{comment}{\#\ Set\ number\ of\ DE-\/MC\ chains}}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00039}\mbox{\hyperlink{namespacemc3__de__mcmc_af134adf18c58098d1ed27762f4b5d5b8}{00039}}\ chains\ =\ 12}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00040}00040\ }
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00041}00041\ \textcolor{comment}{\#\ Set\ prior\ distributions\ for\ fitting\ parameters}}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00042}00042\ \textcolor{comment}{\#\ Calibration\ parameters\ for\ model\ are\ c0\ and\ c1}}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00043}\mbox{\hyperlink{namespacemc3__de__mcmc_a899d3aff6fc24618b39966171b723bcd}{00043}}\ prior\ =\ \ \ \ np.array([0.0,\ 0.0])\ \ \ \ \ \textcolor{comment}{\#\ parameters\ mean\ vector}}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00044}\mbox{\hyperlink{namespacemc3__de__mcmc_a93a86e854a239e6d7bbde96c61637177}{00044}}\ priorlow\ =\ np.array([2.0,\ 2.0])\ \ \ \ \ \textcolor{comment}{\#\ parameters\ -\/1*sigma\ }}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00045}\mbox{\hyperlink{namespacemc3__de__mcmc_a132873269d56c3eb204d496ae2011110}{00045}}\ priorup\ =\ \ np.array([2.0,\ 2.0])\ \ \ \ \ \textcolor{comment}{\#\ parameters\ +1*sigma}}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00046}00046\ }
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00047}00047\ \textcolor{comment}{\#\ Read\ in\ and\ non-\/dimnesionalise\ dislocation\ position-\/time\ data}}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00048}\mbox{\hyperlink{namespacemc3__de__mcmc_a511ae0b1c13f95e5f08f1a0dd3da3d93}{00048}}\ data\ =\ np.loadtxt(\textcolor{stringliteral}{"{}perfect\_pos.txt"{}})\ \ \ }
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00049}00049\ \textcolor{comment}{\#\ Number\ of\ points\ to\ discard\ at\ beginning\ of\ trajectory}}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00050}\mbox{\hyperlink{namespacemc3__de__mcmc_a76f11d9a0a47b94f72c2d0e77fb32240}{00050}}\ n\ =\ 7}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00051}00051\ }
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00052}00052\ \textcolor{keywordflow}{if}\ n\ ==\ 0:}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00053}00053\ \ \ \ \ \textcolor{comment}{\#\ time}}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00054}\mbox{\hyperlink{namespacemc3__de__mcmc_aed39282eeeb6b1970c1ce27485e91afe}{00054}}\ \ \ \ \ t\_data\ =\ data[:,0]}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00055}\mbox{\hyperlink{namespacemc3__de__mcmc_a5d751bacdd9e4d26d056f5398ae4246e}{00055}}\ \ \ \ \ t\_range\ =\ np.ptp(t\_data)}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00056}00056\ \ \ \ \ t\_data\ =\ data[:,0]/t\_range}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00057}00057\ \ \ \ \ \textcolor{comment}{\#\ position\ data}}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00058}\mbox{\hyperlink{namespacemc3__de__mcmc_a5637c0fc79271593e595e5f5a28a042e}{00058}}\ \ \ \ \ x\_data\ =\ 0.1*data[:,1]\ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Convert\ from\ Angstroms\ to\ nm}}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00059}\mbox{\hyperlink{namespacemc3__de__mcmc_a5a4e70aef1b59c2077e838835e0ad13c}{00059}}\ \ \ \ \ x\_range\ =\ np.ptp(x\_data)}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00060}\mbox{\hyperlink{namespacemc3__de__mcmc_a39291e1e7c5545a7b8a9c64b89d973f9}{00060}}\ \ \ \ \ xi\ =\ x\_data[0]}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00061}00061\ \ \ \ \ x\_data\ =\ (x\_data-\/xi)/x\_range}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00062}00062\ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00063}00063\ \ \ \ \ \textcolor{comment}{\#\ time}}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00064}00064\ \ \ \ \ t\_data\ =\ data[:-\/n,0]}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00065}00065\ \ \ \ \ t\_range\ =\ np.ptp(t\_data)}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00066}00066\ \ \ \ \ t\_data\ =\ data[:-\/n,0]/t\_range}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00067}00067\ \ \ \ \ \textcolor{comment}{\#\ position\ data}}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00068}00068\ \ \ \ \ x\_data\ =\ 0.1*data[n:,1]\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Convert\ from\ Angstroms\ to\ nm}}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00069}00069\ \ \ \ \ x\_range\ =\ np.ptp(x\_data)}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00070}00070\ \ \ \ \ xi\ =\ x\_data[0]}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00071}00071\ \ \ \ \ x\_data\ =\ (x\_data-\/xi)/x\_range}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00072}00072\ }
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00073}00073\ \textcolor{comment}{\#\ Non-\/dimensional\ Model}}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00074}\mbox{\hyperlink{namespacemc3__de__mcmc_a5619c74ce95a8ede9f11ebff7d728dcf}{00074}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacemc3__de__mcmc_a5619c74ce95a8ede9f11ebff7d728dcf}{x\_derivatives}}(x,t,c0,c1):}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00075}00075\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00076}00076\ \textcolor{stringliteral}{\ \ \ \ Defines\ the\ derivatives\ needed\ to\ solve\ the\ non-\/dimensional\ equation\ of\ motion\ x"{}\ +\ c0*x'\ =\ c1}}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00077}00077\ \textcolor{stringliteral}{\ \ \ \ }}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00078}00078\ \textcolor{stringliteral}{\ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00079}00079\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00080}00080\ \textcolor{stringliteral}{\ \ \ \ x\ \ :\ numpy.ndarray\ }}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00081}00081\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ LHS\ row\ vector\ (dependent\ variable)}}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00082}00082\ \textcolor{stringliteral}{\ \ \ \ t\ \ :\ numpy.ndarray}}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00083}00083\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ Time\ (the\ independent\ variable)}}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00084}00084\ \textcolor{stringliteral}{\ \ \ \ c0\ :\ float}}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00085}00085\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ Non-\/dimensional\ parameter\ -\/\ B/m}}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00086}00086\ \textcolor{stringliteral}{\ \ \ \ c1\ \ :\ float}}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00087}00087\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ Non-\/dimensional\ parameter\ -\/\ F/m}}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00088}00088\ \textcolor{stringliteral}{\ \ \ \ Returns}}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00089}00089\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00090}00090\ \textcolor{stringliteral}{\ \ \ \ numpy.ndarray}}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00091}00091\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ Derrivates.}}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00092}00092\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00093}00093\ \ \ \ \ dxdt\ =\ [x[1],\ np.exp(c1)-\/\ np.exp(c0)*x[1]]}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00094}00094\ \ \ \ \ \textcolor{keywordflow}{return}\ dxdt}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00095}00095\ }
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00096}00096\ \textcolor{comment}{\#\ Set\ the\ initial\ conditions\ -\/\ initial\ position\ and\ velocity}}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00097}\mbox{\hyperlink{namespacemc3__de__mcmc_a7bae07f096dd3fd9016a444d18e13045}{00097}}\ x0\ =\ [0.0,0.0]\ \ }
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00098}00098\ }
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00099}\mbox{\hyperlink{namespacemc3__de__mcmc_a864f85bd9175f281dde1d54106019151}{00099}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacemc3__de__mcmc_a864f85bd9175f281dde1d54106019151}{ODE\_solution}}(t):}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00100}00100\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00101}00101\ \textcolor{stringliteral}{\ \ \ \ Solves\ the\ differential\ equation\ x"{}\ +\ c0*x'\ =\ c1}}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00102}00102\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00103}00103\ \textcolor{stringliteral}{\ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00104}00104\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00105}00105\ \textcolor{stringliteral}{\ \ \ \ t\ :\ numpy.ndarray}}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00106}00106\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Vector\ of\ fitting\ parameters}}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00107}00107\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00108}00108\ \ \ \ \ c0,\ c1\ =\ t\ \ \textcolor{comment}{\#\ Unpack\ parameters}}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00109}00109\ \ \ \ \ position,\ velocity\ =\ odeint(x\_derivatives,\ x0,\ t\_data,\ args=(c0,c1)).T}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00110}00110\ \ \ \ \ \textcolor{keywordflow}{return}\ position}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00111}00111\ }
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00112}00112\ \textcolor{comment}{\#\ MC3\ settings}}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00113}00113\ }
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00114}00114\ \textcolor{comment}{\#\ Input\ data}}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00115}00115\ data\ =\ np.array(x\_data)}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00116}\mbox{\hyperlink{namespacemc3__de__mcmc_ac33893cd2372530dd314821accb2b5bf}{00116}}\ uncert\ =\ [np.sqrt(0.025)\ \textcolor{keywordflow}{for}\ i\ \textcolor{keywordflow}{in}\ range(len(x\_data))]}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00117}00117\ }
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00118}00118\ \textcolor{comment}{\#\ Modelling\ function}}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00119}\mbox{\hyperlink{namespacemc3__de__mcmc_a3699148440db7bdde6e95e16092363d1}{00119}}\ func\ =\ ODE\_solution}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00120}00120\ }
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00121}00121\ \textcolor{comment}{\#\ Fitting\ Parameters\ -\/\ initial\ guesses}}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00122}\mbox{\hyperlink{namespacemc3__de__mcmc_a484873c74138512e41bc50d17b7d955a}{00122}}\ ndims\ =\ 2}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00123}\mbox{\hyperlink{namespacemc3__de__mcmc_a41000f175dc0115080e2a682cc06dbe9}{00123}}\ params\ =\ np.random.random(ndims)}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00124}00124\ }
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00125}00125\ \textcolor{comment}{\#\ Parameters\ stepping\ behavior}}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00126}\mbox{\hyperlink{namespacemc3__de__mcmc_a2e878e6631d1d5c32cb8255685fb5873}{00126}}\ pstep\ =\ np.array([1.0,\ 1.0])}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00127}00127\ }
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00128}00128\ \textcolor{comment}{\#\ Parameter\ names}}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00129}\mbox{\hyperlink{namespacemc3__de__mcmc_a9ef70fcb7c461949595ef21bfb46767a}{00129}}\ pnames\ =\ [\textcolor{stringliteral}{"{}c0"{}},\ \textcolor{stringliteral}{"{}c1"{}}]}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00130}\mbox{\hyperlink{namespacemc3__de__mcmc_a24d1a61d55970de3d60e08137eee93c5}{00130}}\ textnames\ =\ [\textcolor{stringliteral}{r"{}c\_\{0\}"{}},\ \textcolor{stringliteral}{r"{}c\_\{1\}"{}}]}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00131}00131\ }
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00132}00132\ \textcolor{comment}{\#\ Sampler\ algorithm}}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00133}\mbox{\hyperlink{namespacemc3__de__mcmc_a71d9b0b34bf9d29928539ce91402fec7}{00133}}\ sampler\ =\ \textcolor{stringliteral}{"{}snooker"{}}}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00134}00134\ }
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00135}00135\ \textcolor{comment}{\#\ MCMC\ Configuration}}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00136}\mbox{\hyperlink{namespacemc3__de__mcmc_a1d7032fb58a83cdde2d9963a8f76c7d3}{00136}}\ nsamples\ =\ 1e6\ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Number\ of\ MCMC\ iterations}}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00137}\mbox{\hyperlink{namespacemc3__de__mcmc_a57ee564b3180b28884295f579dac6851}{00137}}\ burnin\ =\ 0\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Number\ of\ burn\ in\ samples\ -\/\ This\ is\ taken\ care\ of\ in\ analysis\ scripts}}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00138}\mbox{\hyperlink{namespacemc3__de__mcmc_afe756bbb491f1c0b4bba49a3d475a2b2}{00138}}\ nchains\ =\ chains\ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Number\ of\ MCMC\ chains}}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00139}\mbox{\hyperlink{namespacemc3__de__mcmc_a6201a0661c3d5b88df5f63529298eb48}{00139}}\ ncpu\ =\ 7\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Number\ of\ CPUs\ }}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00140}\mbox{\hyperlink{namespacemc3__de__mcmc_a73901b89090c7acb9ea14b91fbfc1791}{00140}}\ thinning\ =\ 1\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ }}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00141}00141\ }
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00142}00142\ \textcolor{comment}{\#\ Pre-\/MCMC\ setup}}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00143}\mbox{\hyperlink{namespacemc3__de__mcmc_af214026ac56627508ed619270adc6ccb}{00143}}\ kickoff\ =\ \textcolor{stringliteral}{"{}normal"{}}\ \ \ \ \ \ \textcolor{comment}{\#\ MCMC\ initial\ draw\ -\/\ can\ also\ be\ "{}uniform"{}}}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00144}\mbox{\hyperlink{namespacemc3__de__mcmc_a318dc897fbcde3d1413b0128a9b0d342}{00144}}\ hsize\ =\ 10\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ DE-\/MC\ snooker\ pre-\/MCMC\ sample\ size}}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00145}00145\ }
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00146}00146\ \textcolor{comment}{\#\ Convergence}}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00147}\mbox{\hyperlink{namespacemc3__de__mcmc_a798e8eb818f39a4eb0cf08929403d30e}{00147}}\ grtest\ =\ \textcolor{keyword}{True}\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Run\ Gelman-\/Rubin\ convergence\ test}}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00148}\mbox{\hyperlink{namespacemc3__de__mcmc_a2378b5257a2ca3ff99729439ecaa9ba6}{00148}}\ grbreak\ =\ 0.0\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Convergence\ threshold\ to\ stop\ MCMC\ -\/\ 0.0\ is\ no\ break}}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00149}\mbox{\hyperlink{namespacemc3__de__mcmc_a326c3548c6977e9e9efe1cb2fc107c29}{00149}}\ grnmin\ =\ 0.5}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00150}00150\ }
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00151}00151\ \textcolor{comment}{\#\ Fine-\/tuning}}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00152}\mbox{\hyperlink{namespacemc3__de__mcmc_a87f922d1c1d0c26e61fcfaeb408f9a2b}{00152}}\ fgamma\ =\ 1.0\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Scale\ factor\ for\ DEMC's\ gamma\ jump}}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00153}\mbox{\hyperlink{namespacemc3__de__mcmc_aa2914e5636a5b93b5bea95c2badaf7cf}{00153}}\ fepsilon\ =\ 0.0\ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Jump\ scale\ factor\ for\ DEMC's\ "{}e"{}\ distribution}}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00154}00154\ }
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00155}00155\ \textcolor{comment}{\#\ Logging}}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00156}\mbox{\hyperlink{namespacemc3__de__mcmc_a0d53916ead8724126518e4b16b78ba0f}{00156}}\ log\ =\ \textcolor{stringliteral}{"{}de\_mcmc.log"{}}\ \ \ \ \ \textcolor{comment}{\#\ Log\ file\ name}}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00157}00157\ }
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00158}00158\ \textcolor{comment}{\#\ Output\ and\ plotting\ settings}}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00159}\mbox{\hyperlink{namespacemc3__de__mcmc_ad10ccc06ad4c18693e839c24e23a470d}{00159}}\ savefile\ =\ \textcolor{stringliteral}{'de\_mcmc.npz'}}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00160}\mbox{\hyperlink{namespacemc3__de__mcmc_a4e7e74ba5163b07429e0cff22fffe93e}{00160}}\ plots\ =\ \textcolor{keyword}{True}}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00161}\mbox{\hyperlink{namespacemc3__de__mcmc_aed233a7939a79ac9011b5c18e7126e23}{00161}}\ theme\ =\ \textcolor{stringliteral}{'indigo'}}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00162}\mbox{\hyperlink{namespacemc3__de__mcmc_acd3f668781d1800aea9821a224361718}{00162}}\ statistics\ =\ \textcolor{stringliteral}{'med\_central'}}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00163}\mbox{\hyperlink{namespacemc3__de__mcmc_aefa7c995dd1c679dd84f78f4e65454dc}{00163}}\ rms\ =\ \textcolor{keyword}{True}}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00164}00164\ }
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00165}00165\ \textcolor{comment}{\#\ DE-\/MC\ run}}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00166}\mbox{\hyperlink{namespacemc3__de__mcmc_a9a8d37e4899f05c230ed788491012e1d}{00166}}\ dir\ =\ out\_dir}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00167}00167\ os.mkdir(dir)}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00168}00168\ os.chdir(dir)}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00169}00169\ }
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00170}\mbox{\hyperlink{namespacemc3__de__mcmc_ad288825273ed7192429ab0474fb2d4a0}{00170}}\ output\ =\ mc3.sample(}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00171}00171\ \ \ \ \ data=data,\ uncert=uncert,\ func=func,\ params=params,\ pstep=pstep,}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00172}00172\ \ \ \ \ pnames=pnames,\ texnames=textnames,}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00173}00173\ \ \ \ \ prior=prior,\ priorlow=priorlow,\ priorup=priorup,}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00174}00174\ \ \ \ \ sampler=sampler,\ nsamples=nsamples,\ \ nchains=nchains,}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00175}00175\ \ \ \ \ ncpu=ncpu,\ burnin=burnin,\ thinning=thinning,}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00176}00176\ \ \ \ \ leastsq=\textcolor{keywordtype}{None},\ chisqscale=\textcolor{keyword}{False},}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00177}00177\ \ \ \ \ grtest=grtest,\ grbreak=grbreak,\ grnmin=grnmin,}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00178}00178\ \ \ \ \ hsize=hsize,\ kickoff=kickoff,\ log=log,}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00179}00179\ \ \ \ \ plots=plots,\ theme=theme,\ statistics=statistics,}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00180}00180\ \ \ \ \ savefile=savefile,\ rms=rms}
\DoxyCodeLine{\Hypertarget{mc3__de__mcmc_8py_source_l00181}00181\ )}

\end{DoxyCode}
