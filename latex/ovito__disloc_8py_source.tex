\doxysection{ovito\+\_\+disloc.\+py}
\hypertarget{ovito__disloc_8py_source}{}\label{ovito__disloc_8py_source}\index{dislocation\_tracking/ovito\_disloc.py@{dislocation\_tracking/ovito\_disloc.py}}
\mbox{\hyperlink{ovito__disloc_8py}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{ovito__disloc_8py_source_l00001}\mbox{\hyperlink{namespaceovito__disloc}{00001}}\ \textcolor{stringliteral}{"{}"{}"{}!\ @ref}}
\DoxyCodeLine{\Hypertarget{ovito__disloc_8py_source_l00002}00002\ \textcolor{stringliteral}{Post-\/proceesing\ of\ dislocation\ MD\ trajectories.}}
\DoxyCodeLine{\Hypertarget{ovito__disloc_8py_source_l00003}00003\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{ovito__disloc_8py_source_l00004}00004\ \textcolor{stringliteral}{This\ script\ reads\ in\ a\ series\ of\ LAMMPS\ dump\ files\ containing\ unwrapped\ atom\ coordinates\ and\ uses\ OVITO's\ Dislocation\ Analysis\ (DXA)\ tool\ to\ detect\ edge\ dislocations.\ }}
\DoxyCodeLine{\Hypertarget{ovito__disloc_8py_source_l00005}00005\ \textcolor{stringliteral}{The\ script\ outputs\ a\ series\ of\ text\ files\ (one\ for\ each\ frame\ in\ the\ trajectory)\ containing\ the\ following:\ the\ number\ of\ dislocations\ detected;\ the\ dislocation\ index;\ the\ }}
\DoxyCodeLine{\Hypertarget{ovito__disloc_8py_source_l00006}00006\ \textcolor{stringliteral}{number\ of\ vertices\ in\ a\ detected\ dislocation\ line;\ the\ x,\ y,\ and\ z\ cooridnates\ of\ each\ vertex.}}
\DoxyCodeLine{\Hypertarget{ovito__disloc_8py_source_l00007}00007\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{ovito__disloc_8py_source_l00008}00008\ \textcolor{stringliteral}{The\ dislocations\ are\ not\ consistently\ indexed\ across\ the\ trajectory,\ which\ makes\ it\ difficult\ to\ track\ a\ given\ dislocation\ and\ analyse\ it.\ This\ is\ taken\ care\ of\ in\ the\ script\ }}
\DoxyCodeLine{\Hypertarget{ovito__disloc_8py_source_l00009}00009\ \textcolor{stringliteral}{dislocation\_script.py,\ which\ reads\ in\ and\ processes\ the\ text\ files\ generated\ by\ this\ script\ and\ outputs\ a\ given\ dislocation's\ position\ as\ a\ timeseries\ for\ further\ analysis.}}
\DoxyCodeLine{\Hypertarget{ovito__disloc_8py_source_l00010}00010\ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{ovito__disloc_8py_source_l00011}00011\ \textcolor{keyword}{import}\ numpy\ \textcolor{keyword}{as}\ np}
\DoxyCodeLine{\Hypertarget{ovito__disloc_8py_source_l00012}00012\ \textcolor{keyword}{import}\ os}
\DoxyCodeLine{\Hypertarget{ovito__disloc_8py_source_l00013}00013\ \textcolor{keyword}{import}\ time}
\DoxyCodeLine{\Hypertarget{ovito__disloc_8py_source_l00014}00014\ \textcolor{keyword}{from}\ natsort\ \textcolor{keyword}{import}\ natsorted}
\DoxyCodeLine{\Hypertarget{ovito__disloc_8py_source_l00015}00015\ }
\DoxyCodeLine{\Hypertarget{ovito__disloc_8py_source_l00016}00016\ \textcolor{keyword}{from}\ ovito.io\ \textcolor{keyword}{import}\ import\_file,\ export\_file}
\DoxyCodeLine{\Hypertarget{ovito__disloc_8py_source_l00017}00017\ \textcolor{keyword}{from}\ ovito.modifiers\ \textcolor{keyword}{import}\ DislocationAnalysisModifier}
\DoxyCodeLine{\Hypertarget{ovito__disloc_8py_source_l00018}00018\ \textcolor{keyword}{from}\ ovito.data\ \textcolor{keyword}{import}\ DislocationNetwork}
\DoxyCodeLine{\Hypertarget{ovito__disloc_8py_source_l00019}00019\ }
\DoxyCodeLine{\Hypertarget{ovito__disloc_8py_source_l00020}00020\ \textcolor{keyword}{import}\ ovito}
\DoxyCodeLine{\Hypertarget{ovito__disloc_8py_source_l00021}00021\ ovito.enable\_logging()}
\DoxyCodeLine{\Hypertarget{ovito__disloc_8py_source_l00022}00022\ }
\DoxyCodeLine{\Hypertarget{ovito__disloc_8py_source_l00023}\mbox{\hyperlink{namespaceovito__disloc_a92255abb174a4e9185f563d840598300}{00023}}\ start\_frame\ =\ 0}
\DoxyCodeLine{\Hypertarget{ovito__disloc_8py_source_l00024}00024\ }
\DoxyCodeLine{\Hypertarget{ovito__disloc_8py_source_l00025}00025\ \textcolor{comment}{\#\ Set\ dump\ file\ writing\ frequency\ -\/\ every\ n\ timesteps}}
\DoxyCodeLine{\Hypertarget{ovito__disloc_8py_source_l00026}\mbox{\hyperlink{namespaceovito__disloc_abc16e65f240ed0c8f3e876e8732c0a33}{00026}}\ step\ =\ 500}
\DoxyCodeLine{\Hypertarget{ovito__disloc_8py_source_l00027}00027\ }
\DoxyCodeLine{\Hypertarget{ovito__disloc_8py_source_l00028}00028\ \textcolor{comment}{\#\ Load\ structure(s)}}
\DoxyCodeLine{\Hypertarget{ovito__disloc_8py_source_l00029}\mbox{\hyperlink{namespaceovito__disloc_a2320134bb04bbea3b4d6ff0569d3a746}{00029}}\ pipeline\ =\ import\_file(\textcolor{stringliteral}{"{}./dumps/dump.shear\_unwrap.*"{}})}
\DoxyCodeLine{\Hypertarget{ovito__disloc_8py_source_l00030}\mbox{\hyperlink{namespaceovito__disloc_a511ae0b1c13f95e5f08f1a0dd3da3d93}{00030}}\ data\ =\ pipeline.compute()}
\DoxyCodeLine{\Hypertarget{ovito__disloc_8py_source_l00031}00031\ }
\DoxyCodeLine{\Hypertarget{ovito__disloc_8py_source_l00032}00032\ \textcolor{comment}{\#\ Set\ up\ dislocation\ analysis\ modifier}}
\DoxyCodeLine{\Hypertarget{ovito__disloc_8py_source_l00033}\mbox{\hyperlink{namespaceovito__disloc_aecb3dec591663cb6c8db856eb53e7c15}{00033}}\ modifier\ =\ DislocationAnalysisModifier()}
\DoxyCodeLine{\Hypertarget{ovito__disloc_8py_source_l00034}\mbox{\hyperlink{namespaceovito__disloc_a961a715d3a56868755d9d823693db49a}{00034}}\ modifier.input\_crystal\_structure\ =\ DislocationAnalysisModifier.Lattice.FCC}
\DoxyCodeLine{\Hypertarget{ovito__disloc_8py_source_l00035}00035\ pipeline.modifiers.append(modifier)}
\DoxyCodeLine{\Hypertarget{ovito__disloc_8py_source_l00036}00036\ }
\DoxyCodeLine{\Hypertarget{ovito__disloc_8py_source_l00037}00037\ \textcolor{comment}{\#\ Evaluate\ pipeline\ at\ every\ frame}}
\DoxyCodeLine{\Hypertarget{ovito__disloc_8py_source_l00038}00038\ \textcolor{comment}{\#\ Write\ dislocation\ output\ files\ for\ analysis}}
\DoxyCodeLine{\Hypertarget{ovito__disloc_8py_source_l00039}\mbox{\hyperlink{namespaceovito__disloc_a550769bbd4e7537ff90a656f5b0c23b2}{00039}}\ start\ =\ time.time()}
\DoxyCodeLine{\Hypertarget{ovito__disloc_8py_source_l00040}00040\ \textcolor{keywordflow}{for}\ frame\ \textcolor{keywordflow}{in}\ range(pipeline.source.num\_frames):}
\DoxyCodeLine{\Hypertarget{ovito__disloc_8py_source_l00041}00041\ \ \ \ \ data\ =\ pipeline.compute(frame)}
\DoxyCodeLine{\Hypertarget{ovito__disloc_8py_source_l00042}00042\ }
\DoxyCodeLine{\Hypertarget{ovito__disloc_8py_source_l00043}00043\ \ \ \ \ \textcolor{comment}{\#\ Extract\ outputs}}
\DoxyCodeLine{\Hypertarget{ovito__disloc_8py_source_l00044}00044\ \ \ \ \ \textcolor{comment}{\#\ Number\ of\ dislocations\ found}}
\DoxyCodeLine{\Hypertarget{ovito__disloc_8py_source_l00045}\mbox{\hyperlink{namespaceovito__disloc_a90e037bb66e6611a70b17ddf4369bcc5}{00045}}\ \ \ \ \ ndisloc\ =\ len(data.dislocations.segments)}
\DoxyCodeLine{\Hypertarget{ovito__disloc_8py_source_l00046}00046\ }
\DoxyCodeLine{\Hypertarget{ovito__disloc_8py_source_l00047}00047\ \ \ \ \ \textcolor{comment}{\#\ Number\ and\ coordinates\ of\ vertices}}
\DoxyCodeLine{\Hypertarget{ovito__disloc_8py_source_l00048}\mbox{\hyperlink{namespaceovito__disloc_a818eb20de7c947175f387d0aa3efdba0}{00048}}\ \ \ \ \ lens\ =\ []}
\DoxyCodeLine{\Hypertarget{ovito__disloc_8py_source_l00049}\mbox{\hyperlink{namespaceovito__disloc_a21135b307d83bdd5f280f8bb9540aec7}{00049}}\ \ \ \ \ vertices\ =\ []}
\DoxyCodeLine{\Hypertarget{ovito__disloc_8py_source_l00050}00050\ \ \ \ \ \textcolor{keywordflow}{for}\ segment\ \textcolor{keywordflow}{in}\ data.dislocations.segments:}
\DoxyCodeLine{\Hypertarget{ovito__disloc_8py_source_l00051}00051\ \ \ \ \ \ \ \ \ lens.append(len(segment.points))}
\DoxyCodeLine{\Hypertarget{ovito__disloc_8py_source_l00052}00052\ \ \ \ \ \ \ \ \ vertices.append(segment.points)}
\DoxyCodeLine{\Hypertarget{ovito__disloc_8py_source_l00053}00053\ }
\DoxyCodeLine{\Hypertarget{ovito__disloc_8py_source_l00054}00054\ \ \ \ \ \textcolor{keyword}{with}\ open(f\textcolor{stringliteral}{"{}./Ni\_disloc/disloc\_data\_\{start\_frame+(frame*step)\}.txt"{}},\ \textcolor{stringliteral}{"{}w"{}})\ \textcolor{keyword}{as}\ fdata:}
\DoxyCodeLine{\Hypertarget{ovito__disloc_8py_source_l00055}00055\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Write\ the\ number\ of\ dislocations\ found}}
\DoxyCodeLine{\Hypertarget{ovito__disloc_8py_source_l00056}00056\ \ \ \ \ \ \ \ \ print(f\textcolor{stringliteral}{"{}Writing\ disloc\_data\_\{start\_frame+(frame*step)\}.txt"{}})}
\DoxyCodeLine{\Hypertarget{ovito__disloc_8py_source_l00057}00057\ \ \ \ \ \ \ \ \ fdata.write(f\textcolor{stringliteral}{"{}\{ndisloc\}\ \(\backslash\)n"{}})}
\DoxyCodeLine{\Hypertarget{ovito__disloc_8py_source_l00058}00058\ }
\DoxyCodeLine{\Hypertarget{ovito__disloc_8py_source_l00059}00059\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ j,\ length\ \textcolor{keywordflow}{in}\ enumerate(lens):}
\DoxyCodeLine{\Hypertarget{ovito__disloc_8py_source_l00060}00060\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Dislocation\ index}}
\DoxyCodeLine{\Hypertarget{ovito__disloc_8py_source_l00061}00061\ \ \ \ \ \ \ \ \ \ \ \ \ fdata.write(f\textcolor{stringliteral}{"{}\{j\}\ \(\backslash\)n"{}})}
\DoxyCodeLine{\Hypertarget{ovito__disloc_8py_source_l00062}00062\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Number\ of\ vertices}}
\DoxyCodeLine{\Hypertarget{ovito__disloc_8py_source_l00063}00063\ \ \ \ \ \ \ \ \ \ \ \ \ fdata.write(f\textcolor{stringliteral}{"{}\{length\}\ \(\backslash\)n"{}})}
\DoxyCodeLine{\Hypertarget{ovito__disloc_8py_source_l00064}00064\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Coordinates\ of\ vertices}}
\DoxyCodeLine{\Hypertarget{ovito__disloc_8py_source_l00065}00065\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ coords\ \textcolor{keywordflow}{in}\ vertices[j]:}
\DoxyCodeLine{\Hypertarget{ovito__disloc_8py_source_l00066}00066\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ fdata.write(f\textcolor{stringliteral}{"{}\{coords[0]\}\ \{coords[1]\}\ \{coords[2]\}\ \(\backslash\)n"{}})}
\DoxyCodeLine{\Hypertarget{ovito__disloc_8py_source_l00067}00067\ \ \ \ \ \ \ \ \ fdata.close()}
\DoxyCodeLine{\Hypertarget{ovito__disloc_8py_source_l00068}00068\ }
\DoxyCodeLine{\Hypertarget{ovito__disloc_8py_source_l00069}00069\ \ \ \ \ \ \ \ \ print(f\textcolor{stringliteral}{"{}Written\ disloc\_data\_\{frame*step\}.txt"{}})}
\DoxyCodeLine{\Hypertarget{ovito__disloc_8py_source_l00070}00070\ }
\DoxyCodeLine{\Hypertarget{ovito__disloc_8py_source_l00071}00071\ \ \ \ \ \textcolor{comment}{\#\ Export\ dislocation\ lines\ to\ a\ CA\ file:}}
\DoxyCodeLine{\Hypertarget{ovito__disloc_8py_source_l00072}00072\ \ \ \ \ export\_file(data,\ f\textcolor{stringliteral}{"{}./Ni\_disloc/dislocations\_\{frame*step\}.ca"{}},\ \textcolor{stringliteral}{"{}ca"{}})}
\DoxyCodeLine{\Hypertarget{ovito__disloc_8py_source_l00073}\mbox{\hyperlink{namespaceovito__disloc_afb358f48b1646c750fb9da6c6585be2b}{00073}}\ end\ =\ time.time()}
\DoxyCodeLine{\Hypertarget{ovito__disloc_8py_source_l00074}00074\ print(f\textcolor{stringliteral}{"{}Execution\ time\ =\ \{round(end-\/start,2)\}"{}})}

\end{DoxyCode}
